(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{71459:function(e,t,a){Promise.resolve().then(a.bind(a,96781))},79544:function(e,t,a){"use strict";a.d(t,{f:function(){return l}});var r=a(48983),n=a(61464),o=a(79950);let l=e=>{let{children:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.Controls,{}),(0,r.jsx)(n.MiniMap,{}),(0,r.jsx)(n.Background,{}),t,(0,r.jsx)(o.K,{})]})}},79950:function(e,t,a){"use strict";a.d(t,{K:function(){return x}});var r=a(48983),n=a(61464),o=a(39971),l=a(20557),s=a(74881),i=a(44331),c=a(11375),d=a(21967),u=a(69452),h=a(27321),p=a(46061);let x=()=>(0,r.jsx)(n.Panel,{position:"top-right",children:(0,r.jsx)(g,{})}),g=()=>(0,r.jsxs)(i.v,{children:[(0,r.jsx)(c.j,{as:d.h,icon:(0,r.jsx)(o.E,{}),size:"sm","aria-label":"コントリビューションメニュー",bg:"gray.600",color:"white",_hover:{bg:"black",textDecoration:"none"}}),(0,r.jsxs)(u.q,{children:[(0,r.jsx)(h.sN,{as:p.r,href:"https://github.com/illionillion/mermaid-editor",target:"_blank",rel:"noopener noreferrer",icon:(0,r.jsx)(l.d,{}),children:"リポジトリを見る"}),(0,r.jsx)(h.sN,{as:p.r,href:"https://github.com/illionillion/mermaid-editor/issues/new/choose",target:"_blank",rel:"noopener noreferrer",icon:(0,r.jsx)(s.E,{}),children:"Issueを作成"})]})]})},52020:function(e,t,a){"use strict";a.d(t,{qi:function(){return d},D5:function(){return C},i9:function(){return y}}),a(79950);var r=a(48983),n=a(96172),o=a(80714),l=a(88614),s=a(78861),i=a(68614),c=a(21967);let d=(0,a(12685).memo)((0,l.forwardRef)((e,t)=>{let{value:a,...l}=e,{hasCopied:d,onCopy:u}=(0,s.useClipboard)(a);return(0,r.jsx)(i.u,{alignItems:"center",bg:"success",display:"inline-flex",h:"8",open:d,label:"Copied!",placement:"left",zIndex:"1000",children:(0,r.jsx)(c.h,{ref:t,size:"sm",variant:"unstyled","aria-label":"コードをコピーする",alignItems:"center",bg:["neutral.800","neutral.900"],border:"1px solid",borderColor:d?"success":"whiteAlpha.600",color:d?"success":"whiteAlpha.600",display:"flex",icon:d?(0,r.jsx)(n.n,{fontSize:"lg"}):(0,r.jsx)(o.T,{fontSize:"md"}),justifyContent:"center",_hover:{borderColor:d?"success":"whiteAlpha.800",color:d?"success":"whiteAlpha.800"},...l,onClick:u})})}));var u=a(44331),h=a(11375),p=a(49909),x=a(69452),g=a(27321),f=a(6474),b=a(37550);let m=[{label:"フローチャートエディタ",path:"/flow-chart"},{label:"ER図エディタ",path:"/er-diagram"}],y=()=>{var e,t;let a=null!==(e=(0,b.usePathname)())&&void 0!==e?e:"",n="/"===a,o=n?m.find(e=>"/flow-chart"===e.path):m.find(e=>a.startsWith(e.path)),l=m.filter(e=>!(n?"/flow-chart"===e.path:a.startsWith(e.path)));return(0,r.jsxs)(u.v,{children:[(0,r.jsx)(h.j,{as:p.z,variant:"outline",size:"sm",ml:{base:0,sm:"auto"},children:null!==(t=null==o?void 0:o.label)&&void 0!==t?t:"エディタを選択"}),(0,r.jsx)(x.q,{children:l.map(e=>(0,r.jsx)(g.sN,{as:f.default,href:""!==a?e.path:"#",children:e.label},e.path))})]})};var w=a(85709),j=a(57261),v=a(80010);let C=e=>{let{code:t,showLineNumbers:a=!0,minHeight:n="400px",fontSize:o="14px"}=e;return(0,r.jsx)(w.x,{w:"full",borderRadius:"md",overflow:"auto",border:"1px solid",borderColor:"border",children:(0,r.jsx)(j.Z,{language:"mermaid",style:v.Z,showLineNumbers:a,customStyle:{margin:0,fontSize:o,minHeight:n},children:t})})}},55541:function(e,t,a){"use strict";a.d(t,{W:function(){return s}});var r=a(48983),n=a(85709),o=a(78485),l=a(47104);a(6372),a(50590);let s=e=>{let{value:t,onChange:a,placeholder:s="Mermaidコードを入力...",minHeight:i="300px",fontSize:c="14px"}=e;return(0,r.jsx)(n.x,{w:"full",borderRadius:"md",overflow:"hidden",border:"1px solid",borderColor:"border",bg:"gray.900",color:"white",fontFamily:"mono",sx:{"& textarea::placeholder":{color:"white",opacity:.7}},children:(0,r.jsx)(l.Z,{value:t,onValueChange:a,highlight:e=>{try{return(0,o.highlight)(e,o.languages.mermaid,"mermaid")}catch(t){return e.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"})[e])}},padding:16,placeholder:s,style:{fontFamily:'"Fira code", "Fira Mono", Consolas, Monaco, "Courier New", monospace',fontSize:c,minHeight:i,lineHeight:"1.5",backgroundColor:"transparent",outline:"none",caretColor:"white"}})})}},96781:function(e,t,a){"use strict";a.r(t),a.d(t,{FlowEditor:function(){return e$}});var r=a(48983),n=a(61464),o=a(5301),l=a(78091),s=a(85709),i=a(12685),c=a(79544),d=a(80834),u=a(54117),h=a(67545),p=a(21967);function x(e){let t=new Map,a=new Map;return e.forEach(e=>{var t;a.has(e.source)||a.set(e.source,new Set),null===(t=a.get(e.source))||void 0===t||t.add(e.target)}),e.forEach(e=>{var r,n;let{source:o,target:l}=e;if(null===(r=a.get(l))||void 0===r?void 0:r.has(o)){let a=o<l?"".concat(o,"-").concat(l):"".concat(l,"-").concat(o);t.has(a)||t.set(a,[]),null===(n=t.get(a))||void 0===n||n.push(e)}}),t}let g=(e,t,a,r,n)=>{let o=r.find(t=>t.source===e.source&&t.target===e.target);if(!o)return{adjustedX:t,adjustedY:a};let{offsetX:l,offsetY:s}=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;for(let[,r]of Array.from(x(t).entries())){let t=r.find(t=>t.id===e.id);if(t){let e=r.indexOf(t),n=e%2==0?1:-1,o=Math.floor(e/2+1)*a*n;if(t.target===t.source)return function(e,t,a){let r=t.filter(t=>t.source===e.source&&t.target===e.target),n=r.findIndex(t=>t.id===e.id),o=2*Math.PI/Math.max(r.length,1)*n,l=a*(1+n);return{offsetX:Math.cos(o)*l,offsetY:Math.sin(o)*l}}(t,r,a);return{offsetX:String(t.target).localeCompare(String(t.source),void 0,{numeric:!0})>0?o:-o,offsetY:o}}}return{offsetX:0,offsetY:0}}(o,r);return{adjustedX:t+l,adjustedY:a+s}},f=new Set(["end","start","subgraph","class","classDef","click","style","linkStyle","direction","flowchart","graph","if","else","elseif","while","for","function","return","break","continue"]),b=e=>{if(!e||""===e.trim())return"node_unnamed";let t=e.trim();return f.has(t.toLowerCase())&&(t="node_".concat(t)),/^[0-9]/.test(t)&&(t="_".concat(t)),t=(t=t.replace(/\s+/g,"_")).replace(/[^\w\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/g,"_")},m=(e,t)=>{switch(e){case"rectangle":default:return"[".concat(t,"]");case"diamond":return"{".concat(t,"}");case"rounded":return"(".concat(t,")");case"circle":return"((".concat(t,"))");case"hexagon":return"{{".concat(t,"}}");case"stadium":return"([".concat(t,"])")}},y=e=>e&&""!==e.trim()?/^\d+$/.test(e.trim())?e.trim():/^[a-zA-Z0-9\-_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF\s]+$/.test(e)?e:'"'.concat(e.replace(/"/g,'\\"'),'"'):e,w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"arrow",t=arguments.length>1?arguments[1]:void 0,a=t&&""!==t.trim(),r=a?y(t):"";switch(e){case"arrow":default:return a?" -->|".concat(r,"| "):" --> ";case"thick":return a?" ==>|".concat(r,"| "):" ==> ";case"dotted":return a?" -. ".concat(r," .-> "):" -.-> ";case"invisible":return a?" ~~~|".concat(r,"| "):" ~~~ ";case"bidirectional":return a?" <-->|".concat(r,"| "):" <--> ";case"bidirectional-thick":return a?" <==".concat(r,"==> "):" <==> "}},j=e=>{switch(e){case"arrow":default:return"→";case"thick":return"⇒";case"dotted":return"⇢";case"invisible":return"～";case"bidirectional":return"↔";case"bidirectional-thick":return"⇔"}},v=e=>{switch(e){case"arrow":default:return"通常の矢印 (->)";case"thick":return"太い矢印 (==>)";case"dotted":return"点線矢印 (-.->)";case"invisible":return"非表示 (~~~)";case"bidirectional":return"双方向矢印 (<->)";case"bidirectional-thick":return"太い双方向矢印 (<==>)"}},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TD",a="flowchart ".concat(t,"\n");return e.nodes.forEach(e=>{let t=b(e.data.variableName||"node".concat(e.id)),r=m(e.data.shapeType||"rectangle",e.data.label||"");a+="    ".concat(t).concat(r,"\n")}),e.edges.forEach(t=>{let r=e.nodes.find(e=>e.id===t.source),n=e.nodes.find(e=>e.id===t.target);if(r&&n){var o,l;let e=b(r.data.variableName||"node".concat(r.id)),s=b(n.data.variableName||"node".concat(n.id)),i=null===(o=t.data)||void 0===o?void 0:o.label,c=w((null===(l=t.data)||void 0===l?void 0:l.arrowType)||"arrow",i);a+="    ".concat(e).concat(c).concat(s,"\n")}}),a},k=e=>{let t={nodes:[],edges:[]};if(!e||""===e.trim())return t;let a=e.split("\n").map(e=>e.trim()).filter(e=>e).filter(e=>!e.startsWith("flowchart")&&!e.startsWith("graph")),r=new Map;for(let e of a){let t=S(e);t&&r.set(t.id,t)}for(let e of a){let a=T(e);if(a){if(!r.has(a.source)){let t=E(e,a.source);r.set(a.source,t)}if(!r.has(a.target)){let t=E(e,a.target);r.set(a.target,t)}t.edges.push(a)}}return t.nodes=Array.from(r.values()),t},E=(e,t)=>{for(let{pattern:a,shape:r}of[{pattern:"\\[([^\\]]*)\\]",shape:"rectangle"},{pattern:"\\(\\(([^\\)]*)\\)\\)",shape:"circle"},{pattern:"\\{\\{([^\\}]*)\\}\\}",shape:"hexagon"},{pattern:"\\(\\[([^\\]]*)\\]\\)",shape:"stadium"},{pattern:"\\(([^\\)]*)\\)",shape:"rounded"},{pattern:"\\{([^\\}]*)\\}",shape:"diamond"}]){let n=new RegExp("".concat(t).concat(a)),o=e.match(n);if(o)return{id:t,variableName:t,label:o[1]||t,shapeType:r}}return{id:t,variableName:t,label:t,shapeType:"rectangle"}},S=e=>{if(e.includes("-->")||e.includes("==>")||e.includes("-.->")||e.includes("~~~")||e.includes("<-->")||e.includes("<==>"))return null;for(let t of[{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\[([^\]]*)\]$/,shape:"rectangle"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(\(([^)]*)\)\)$/,shape:"circle"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\{\{([^}]*)\}\}$/,shape:"hexagon"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(\[([^\]]*)\]\)$/,shape:"stadium"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(([^)]*)\)$/,shape:"rounded"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\{([^}]*)\}$/,shape:"diamond"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)$/,shape:"rectangle"}]){let a=e.match(t.regex);if(a){let e=a[1],r=void 0!==a[2]?a[2]:e;if(e.includes(" "))continue;return{id:e,variableName:e,label:r,shapeType:t.shape}}}return null},T=e=>{let t="[a-zA-Z0-9_\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FAF]+",a="(?:\\[[^\\]]*\\]|\\([^)]*\\)|\\{[^}]*\\}|\\(\\([^)]*\\)\\)|\\{\\{[^}]*\\}\\}|\\(\\[[^\\]]*\\]\\))?";for(let r of[{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*<==\\s*(.+?)\\s*==>\\s*(").concat(t,")").concat(a,"$")),arrowType:"bidirectional-thick",labelPosition:"middle"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*<==>\\s*(").concat(t,")").concat(a,"$")),arrowType:"bidirectional-thick"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*<-->\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(a,"$")),arrowType:"bidirectional"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*<--\\s*(.+?)\\s*-->\\s*(").concat(t,")").concat(a,"$")),arrowType:"bidirectional",labelPosition:"middle"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*<-->\\s*(").concat(t,")").concat(a,"$")),arrowType:"bidirectional"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*-\\.\\s*(.+?)\\s*\\.->\\s*(").concat(t,")").concat(a,"$")),arrowType:"dotted",labelPosition:"sides"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*-\\.\\s*->\\s*(").concat(t,")").concat(a,"$")),arrowType:"dotted"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*==>\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(a,"$")),arrowType:"thick"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*==\\s*(.+?)\\s*==>\\s*(").concat(t,")").concat(a,"$")),arrowType:"thick"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*==>\\s*(").concat(t,")").concat(a,"$")),arrowType:"thick"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*-->\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(a,"$")),arrowType:"arrow"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*--\\s*(.+?)\\s*-->\\s*(").concat(t,")").concat(a,"$")),arrowType:"arrow"},{regex:new RegExp("^(".concat(t,")").concat(a,"\\s*-->\\s*(").concat(t,")").concat(a,"$")),arrowType:"arrow"}]){let t=e.match(r.regex);if(t){let e,a;let n="";return"bidirectional-thick"===r.arrowType&&t.length>=4&&t[2]&&""!==t[2].trim()?(e=t[1],n=t[2].trim(),a=t[3]):"sides"===r.labelPosition&&t.length>=4?(e=t[1],n=t[2].trim(),a=t[3]):4===t.length?(e=t[1],n=t[2].trim(),a=t[3]):(e=t[1],a=t[2]),{id:"".concat(e,"-").concat(a),source:e,target:a,label:n,arrowType:r.arrowType}}}return null};var F=a(28043),N=a(44331),z=a(11375),A=a(10800),D=a(69452),_=a(27321);let R=["arrow","thick","dotted","invisible","bidirectional","bidirectional-thick"],M=[{type:"rectangle",label:"四角形",symbol:"[ ]"},{type:"diamond",label:"菱形",symbol:"{ }"},{type:"rounded",label:"角丸四角",symbol:"( )"},{type:"circle",label:"円形",symbol:"(( ))"},{type:"hexagon",label:"六角形",symbol:"{{ }}"},{type:"stadium",label:"スタジアム",symbol:"([ ])"}],I=e=>{let{currentArrowType:t,onArrowTypeChange:a}=e;return(0,r.jsxs)(N.v,{children:[(0,r.jsx)(z.j,{className:"arrow-type-selector-button",as:p.h,"aria-label":"Select arrow type",icon:(0,r.jsx)(F.v,{}),size:"xs",variant:"outline",bg:"white",border:"1px solid",borderColor:"gray.300",_hover:{bg:"gray.50"}}),(0,r.jsx)(A.h,{children:(0,r.jsx)(D.q,{bg:"white",boxShadow:"lg",border:"1px solid",borderColor:"gray.200",children:R.map(e=>(0,r.jsx)(_.sN,{onClick:()=>a(e),bg:t===e?"blue.50":"white",color:t===e?"blue.600":"gray.700",fontSize:"sm",children:v(e)},e))})})]})};function L(e){let{id:t,labelX:a,labelY:n,data:o}=e,[l,c]=(0,i.useState)(!1),[x,g]=(0,i.useState)((null==o?void 0:o.label)||""),[f,b]=(0,i.useState)(!1),m=(0,i.useRef)(null);(0,i.useEffect)(()=>{l&&m.current&&(m.current.focus(),m.current.select())},[l]);let y=()=>{c(!1),(null==o?void 0:o.onLabelChange)&&o.onLabelChange(t,x)};return(0,r.jsx)(s.x,{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(a,"px,").concat(n,"px)"),pointerEvents:"all",className:"nodrag nopan",children:l?(0,r.jsx)(u.I,{ref:m,value:x,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"!==e.key||f?"Escape"===e.key&&(c(!1),g((null==o?void 0:o.label)||"")):y()},onBlur:()=>{y()},onCompositionStart:()=>{b(!0)},onCompositionEnd:()=>{b(!1)},size:"sm",w:"120px",bg:"white",border:"1px solid",borderColor:"gray.300",fontSize:"12px",textAlign:"center"}):(0,r.jsxs)(h.Ug,{gap:"1",align:"center",children:[(0,r.jsxs)(s.x,{onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!0)},bg:"white",p:"1",px:"2",borderRadius:"md",fontSize:"xs",border:"1px solid",borderColor:"gray.300",cursor:"pointer",minW:"20px",textAlign:"center",display:"flex",alignItems:"center",gap:"1",children:[(0,r.jsx)(s.x,{as:"span",color:"blue.600",fontWeight:"bold",children:j((null==o?void 0:o.arrowType)||"arrow")}),(0,r.jsx)(s.x,{as:"span",children:x||"..."})]}),(0,r.jsx)(I,{currentArrowType:(null==o?void 0:o.arrowType)||"arrow",onArrowTypeChange:e=>{(null==o?void 0:o.onArrowTypeChange)&&o.onArrowTypeChange(t,e)}}),(0,r.jsx)(p.h,{"aria-label":"Delete edge",icon:(0,r.jsx)(d.b,{}),size:"xs",variant:"ghost",colorScheme:"red",onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==o?void 0:o.onDelete)&&o.onDelete(t)},bg:"white",border:"1px solid",borderColor:"red.300",_hover:{bg:"red.50"}})]})})}let Z={editableEdge:function(e){var t;let{id:a,sourceX:l,sourceY:s,targetX:i,targetY:c,sourcePosition:d,targetPosition:u,data:h,markerEnd:p,source:f,target:b}=e,{getEdges:m,getNodes:y}=(0,n.useReactFlow)(),w=m(),j=y(),v={id:a,source:f,target:b},[C,k,E]=(0,o.OQ)({sourceX:l,sourceY:s,sourcePosition:d,targetX:i,targetY:c,targetPosition:u}),{adjustedX:S,adjustedY:T}=g(v,k,E,w,j),F=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let[,r]of Array.from(x(t).entries()))if(r.some(t=>t.source===e.source&&t.target===e.target)&&a)return{stroke:"#ff6b6b",strokeOpacity:.8,strokeWidth:2};return{}}(v,w,null!==(t=null==h?void 0:h.enableCyclicEdgeStyling)&&void 0!==t&&t);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.BaseEdge,{path:C,markerEnd:p,style:F}),(0,r.jsx)(n.EdgeLabelRenderer,{children:(0,r.jsx)(L,{id:a,labelX:S,labelY:T,data:h})})]})}};var O=a(11676);let $=e=>{let{value:t,isEditing:a,onDoubleClick:n,onChange:o,onKeyDown:l,onCompositionStart:s,onCompositionEnd:i,onBlur:c}=e;return(0,r.jsx)(r.Fragment,{children:a?(0,r.jsx)(u.I,{value:t,onChange:o,onKeyDown:l,onCompositionStart:s,onCompositionEnd:i,onBlur:c,size:"sm",autoFocus:!0,textAlign:"center",w:"full",h:"24px",p:1,fontSize:"sm",border:"none",bg:"transparent",_focus:{boxShadow:"none",outline:"none"}}):(0,r.jsx)(O.x,{w:"full",fontSize:"sm",fontWeight:"medium",wordBreak:"break-word",lineHeight:"1.2",onDoubleClick:n,children:t})})},P=e=>{let{value:t,isEditing:a,shapeType:n,onClick:o,onChange:l,onKeyDown:i,onCompositionStart:c,onCompositionEnd:d,onBlur:h}=e,p=m(n||"rectangle",t);return(0,r.jsx)(s.x,{position:"absolute",top:"-12px",left:"0px",bg:"blue.500",color:"white",px:1,py:"1px",borderRadius:"sm",fontSize:"10px",fontWeight:"medium",cursor:"pointer",onClick:o,_hover:{bg:"blue.600"},zIndex:10,children:a?(0,r.jsx)(u.I,{value:t,onChange:l,onKeyDown:i,onCompositionStart:c,onCompositionEnd:d,onBlur:h,size:"xs",autoFocus:!0,w:"60px",h:"16px",p:0,fontSize:"10px",bg:"white",color:"black",border:"none",_focus:{boxShadow:"none",outline:"none"}}):p})};var V=a(88614),q=a(33899),B=a(11763),H=a(11236);let W=(0,H.Z)("Grip",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]]);var J=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:W,className:(0,B.cx)("ui-lucide-icon",a),...n})});let X=(0,H.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var Y=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:X,className:(0,B.cx)("ui-lucide-icon",a),...n})});let K=(0,H.Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var U=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:K,className:(0,B.cx)("ui-lucide-icon",a),...n})});let G=(0,H.Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var Q=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:G,className:(0,B.cx)("ui-lucide-icon",a),...n})}),ee=a(59348);let et=(0,H.Z)("Shapes",[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]]);var ea=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:et,className:(0,B.cx)("ui-lucide-icon",a),...n})});let er=e=>{let{currentShape:t,onShapeChange:a}=e;return(0,r.jsxs)(N.v,{children:[(0,r.jsx)(z.j,{as:_.sN,icon:(0,r.jsx)(ea,{fontSize:"xl"}),children:"ノード形状"}),(0,r.jsx)(D.q,{children:M.map(e=>(0,r.jsx)(_.sN,{onClick:()=>null==a?void 0:a(e.type),bg:t===e.type?"primary.50":void 0,children:(0,r.jsxs)(s.x,{display:"flex",alignItems:"center",justifyContent:"space-between",w:"full",children:[(0,r.jsx)(O.x,{children:e.label}),(0,r.jsx)(O.x,{fontSize:"sm",color:"muted",fontFamily:"mono",children:e.symbol})]})},e.type))})]})},en=e=>{let{onEdit:t,onEditVariableName:a,onDelete:n,onShapeChange:o,currentShape:l}=e;return(0,r.jsxs)(N.v,{children:[(0,r.jsx)(z.j,{size:"xs",position:"absolute",top:0,right:0,as:p.h,icon:(0,r.jsx)(J,{fontSize:"2xl"}),variant:"ghost","aria-label":"ノードの操作メニューを開く"}),(0,r.jsxs)(D.q,{children:[(0,r.jsx)(_.sN,{icon:(0,r.jsx)(Y,{fontSize:"xl"}),onClick:t,children:"ラベル編集"}),(0,r.jsx)(_.sN,{icon:(0,r.jsx)(U,{fontSize:"xl"}),onClick:a,children:"変数名編集"}),(0,r.jsx)(ee.C,{}),(0,r.jsx)(er,{currentShape:l,onShapeChange:o}),(0,r.jsx)(ee.C,{}),(0,r.jsx)(_.sN,{color:"danger",icon:(0,r.jsx)(Q,{fontSize:"xl",color:"danger"}),onClick:n,children:"削除"})]})]})},eo=e=>{let{data:t,id:a}=e,[n,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(t.label),[h,p]=(0,i.useState)(t.variableName||"node".concat(a)),[x,g]=(0,i.useState)(!1),f=(0,i.useRef)(0),b=()=>{Date.now()-f.current<300||(l&&y(),o(!0))},m=()=>{o(!1),t.onLabelChange&&t.onLabelChange(a,d)},y=()=>{c(!1),t.onVariableNameChange&&t.onVariableNameChange(a,h)},w=()=>{o(!1),u(t.label)},j=()=>{c(!1),p(t.variableName||"node".concat(a))},v=()=>{g(!0)},C=()=>{g(!1)};return(0,r.jsxs)(s.x,{bg:"white",border:"2px solid #1a365d",borderRadius:"md",p:2,w:"xs",minH:"6xs",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",cursor:"pointer",onDoubleClick:b,_hover:{boxShadow:"md"},position:"relative",children:[(0,r.jsx)(P,{value:h,isEditing:l,shapeType:t.shapeType,onClick:e=>{e.stopPropagation(),e.preventDefault(),f.current=Date.now(),n&&m(),c(!0)},onChange:e=>{p(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||x?"Escape"===e.key&&j():y()},onCompositionStart:v,onCompositionEnd:C,onBlur:y}),(0,r.jsx)(en,{onDelete:()=>{t.onDelete&&t.onDelete(a)},onEdit:()=>{l&&y(),o(!0)},onEditVariableName:()=>{n&&m(),c(!0)},onShapeChange:e=>{var r;null===(r=t.onShapeTypeChange)||void 0===r||r.call(t,a,e)},currentShape:t.shapeType||"rectangle"}),(0,r.jsx)($,{value:d,isEditing:n,onDoubleClick:b,onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||x?"Escape"===e.key&&w():m()},onCompositionStart:v,onCompositionEnd:C,onBlur:m})]})},el={editableNode:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eo,{...e}),(0,r.jsx)(n.Handle,{type:"target",position:o.Ly.Top}),(0,r.jsx)(n.Handle,{type:"source",position:o.Ly.Bottom})]})};var es=a(21431),ei=a(20557),ec=a(50807),ed=a(24289),eu=a(49909),eh=a(52020);let ep=(0,H.Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var ex=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:ep,className:(0,B.cx)("ui-lucide-icon",a),...n})});let eg=(0,H.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var ef=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:eg,className:(0,B.cx)("ui-lucide-icon",a),...n})});let eb=(0,H.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var em=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:eb,className:(0,B.cx)("ui-lucide-icon",a),...n})});let ey=(0,H.Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var ew=(0,V.forwardRef)((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(q.JO,{ref:t,as:ey,className:(0,B.cx)("ui-lucide-icon",a),...n})}),ej=a(34045),ev=a(75557),eC=a(24187),ek=a(42617),eE=a(13839);let eS=[{type:"TD",arrow:ex},{type:"LR",arrow:ef},{type:"RL",arrow:em},{type:"BT",arrow:ew}],eT=e=>{let{open:t,onClose:a,flowData:n}=e,[o,l]=(0,i.useState)("TD"),s=(0,i.useMemo)(()=>C(n,o),[n,o]),c=(0,i.useCallback)(()=>{let e=document.createElement("a"),t=new Blob([s],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="flowchart.mmd",document.body.appendChild(e),e.click(),document.body.removeChild(e)},[s]),{open:d,onOpen:u,onClose:p}=(0,ed.useDisclosure)();return(0,r.jsxs)(ev.u,{open:t,onClose:a,size:"2xl",children:[(0,r.jsx)(eC.x,{children:(0,r.jsxs)(h.Ug,{justify:{base:"space-between",md:"flex-start"},display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",alignItems:"center",children:[(0,r.jsx)(O.x,{children:"生成されたMermaidコード"}),(0,r.jsx)(eu.z,{startIcon:(0,r.jsx)(ej._,{}),colorScheme:"blue",size:"sm",onClick:c,ml:{base:0,md:"auto"},children:"ダウンロード"}),(0,r.jsxs)(N.v,{open:d,onOpen:u,onClose:p,children:[(0,r.jsx)(z.j,{size:"sm",as:eu.z,rightIcon:(0,r.jsx)(F.v,{fontSize:"xl"}),children:o}),(0,r.jsx)(D.q,{children:eS.map(e=>(0,r.jsx)(_.sN,{icon:(0,r.jsx)(e.arrow,{}),bgColor:e.type===o?"primary.50":"transparent",onClick:()=>l(e.type),children:e.type},e.type))})]})]})}),(0,r.jsx)(ek.o,{}),(0,r.jsxs)(eE.f,{pb:6,position:"relative",children:[(0,r.jsx)(eh.qi,{value:s,position:"absolute",top:2,right:6,zIndex:1}),(0,r.jsx)(eh.D5,{code:s})]})]})};var eF=a(20333),eN=a(86899),ez=a(67589),eA=a(55541);let eD=e=>{let{open:t,onClose:a,onImport:n}=e,[o,l]=(0,i.useState)(""),[s,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!1),p=async()=>{if(!o.trim()){c("Mermaidコードを入力してください");return}u(!0),c(null);try{let e=k(o);if(0===e.nodes.length&&0===e.edges.length){c("有効なMermaidコードが見つかりませんでした。ノードまたはエッジの定義を確認してください。");return}n(e),l(""),a()}catch(e){c("Mermaidコードの解析中にエラーが発生しました")}finally{u(!1)}},x=()=>{l(""),c(null),a()};return(0,r.jsxs)(ev.u,{open:t,onClose:x,size:"2xl",children:[(0,r.jsx)(eF.Z,{}),(0,r.jsx)(eC.x,{children:"Mermaidコードインポート"}),(0,r.jsx)(eE.f,{children:(0,r.jsxs)(h.gC,{gap:2,children:[(0,r.jsx)(O.x,{fontSize:"sm",color:"gray.600",children:"Mermaidのフローチャートコードを貼り付けてインポートできます"}),(0,r.jsx)(eA.W,{value:o,onChange:e=>{l(e),c(null)},placeholder:"例:\n".concat("flowchart TD\n    A[開始] --> B{判定}\n    B -->|はい| C[処理A]\n    B -->|いいえ| D[処理B]\n    C --> E[終了]\n    D --> E"),minHeight:"300px"}),s&&(0,r.jsx)(e_,{message:s}),(0,r.jsx)(O.x,{fontSize:"xs",color:"gray.500",children:"\uD83D\uDCA1 対応しているノード形状: 四角形[label], ダイヤモンド{label}, 円((label)), 六角形{{label}}, スタジアム([label]), 角丸(label)"})]})}),(0,r.jsxs)(eN.m,{children:[(0,r.jsx)(eu.z,{onClick:x,children:"キャンセル"}),(0,r.jsx)(eu.z,{colorScheme:"blue",onClick:p,loading:d,loadingText:"インポート中...",disabled:!o.trim(),children:"インポート"})]})]})},e_=e=>{let{message:t}=e;return(0,r.jsxs)(ez.bZ,{status:"error",children:[(0,r.jsx)(ez.zM,{}),(0,r.jsx)(ez.X,{children:t})]})},eR=e=>{let{onAddNode:t,onImportMermaid:a,nodes:o,edges:l}=e;return(0,r.jsx)(n.Panel,{position:"top-left",children:(0,r.jsx)(eM,{onAddNode:t,onImportMermaid:a,nodes:o,edges:l})})},eM=e=>{let{onAddNode:t,onImportMermaid:a,nodes:n,edges:o}=e,{open:l,onOpen:s,onClose:i}=(0,ed.useDisclosure)(),{open:c,onOpen:d,onClose:u}=(0,ed.useDisclosure)();return(0,r.jsxs)(h.gC,{gap:4,p:4,bg:"white",borderRadius:"md",boxShadow:"md",children:[(0,r.jsxs)(h.Ug,{w:"full",display:{base:"flex",sm:"inline-flex"},flexWrap:"wrap",justify:"space-between",children:[(0,r.jsx)(O.x,{fontSize:"lg",fontWeight:"bold",children:"Mermaid フローチャート エディター"}),(0,r.jsx)(eh.i9,{})]}),(0,r.jsxs)(h.gC,{gap:2,align:"start",children:[(0,r.jsx)(O.x,{fontSize:"sm",color:"gray.600",children:"\uD83D\uDCA1 ヒント: ノードをダブルクリックで編集、ドラッグして空の場所で新ノード作成"}),(0,r.jsxs)(h.Ug,{gap:2,display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",children:[(0,r.jsx)(eu.z,{startIcon:(0,r.jsx)(es.p,{}),colorScheme:"blue",size:"sm",onClick:t,children:"ノード追加"}),(0,r.jsx)(eu.z,{startIcon:(0,r.jsx)(ei.d,{}),colorScheme:"green",size:"sm",onClick:d,children:"コード生成"}),(0,r.jsx)(eu.z,{startIcon:(0,r.jsx)(ec.r,{}),colorScheme:"purple",size:"sm",onClick:s,children:"インポート"})]})]}),(0,r.jsx)(eD,{open:l,onClose:i,onImport:a}),(0,r.jsx)(eT,{open:c,onClose:u,flowData:{nodes:n,edges:o}})]})};function eI(e,t,a){return{id:e.toString(),type:"editableNode",position:t,data:{label:"Node ".concat(e),variableName:"node".concat(e),shapeType:"rectangle",...a}}}let eL={LEVEL_HEIGHT:150,NODE_SPACING:250,CENTER_OFFSET:300,VERTICAL_OFFSET:50},eZ=[{id:"1",type:"editableNode",position:{x:250,y:5},data:{label:"Start",variableName:"startNode",shapeType:"rectangle"}}],eO=[];function e$(){let[e,t,a]=(0,n.useNodesState)(eZ),[d,u,h]=(0,n.useEdgesState)(eO),[p,x]=(0,i.useState)(2),g=(0,i.useRef)(null),{screenToFlowPosition:f}=(0,n.useReactFlow)(),b=(0,l.useToken)("sizes","xs"),m=(0,l.useToken)("sizes","6xs"),y=(e,t)=>{if(!e)return t;let a=parseFloat(e.replace("px","").replace("rem",""));return isNaN(a)?t:e.includes("rem")?16*a:a},w=y(b,80),j=y(m,48),v=(0,i.useCallback)((e,a)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,label:a}}:t))},[t]),C=(0,i.useCallback)((e,a)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,variableName:a}}:t))},[t]),k=(0,i.useCallback)((e,a)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,shapeType:a}}:t))},[t]),E=(0,i.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e)),u(t=>t.filter(t=>t.source!==e&&t.target!==e))},[t,u]),S=(0,i.useCallback)((e,t)=>{u(a=>a.map(a=>a.id===e?{...a,data:{...a.data,label:t}}:a))},[u]),T=(0,i.useCallback)(e=>{u(t=>t.filter(t=>t.id!==e))},[u]),F=(0,i.useCallback)((e,t)=>{u(a=>a.map(a=>a.id===e?{...a,data:{...a.data,arrowType:t}}:a))},[u]);(0,i.useEffect)(()=>{t(e=>e.map(e=>({...e,data:{...e.data,onLabelChange:v,onVariableNameChange:C,onShapeTypeChange:k,onDelete:E}})))},[v,C,k,E,t]),(0,i.useEffect)(()=>{u(e=>e.map(e=>({...e,type:"editableEdge",data:{...e.data,onLabelChange:S,onArrowTypeChange:F,onDelete:T}})))},[S,F,T,u]);let N=(0,i.useCallback)(e=>{let t={...e,type:"editableEdge",data:{label:"",arrowType:"arrow",onLabelChange:S,onArrowTypeChange:F,onDelete:T}};u(e=>(0,o.Z_)(t,e)),g.current="connected"},[u,S,F,T]),z=(0,i.useCallback)((e,t)=>{g.current=t.nodeId,g.current="".concat(t.nodeId,"-").concat(t.handleType)},[]),A=(0,i.useCallback)(a=>{var r,n,o,l;if(g.current){if("connected"===g.current){g.current=null;return}if(((null==a?void 0:null===(n=a.target)||void 0===n?void 0:null===(r=n.classList)||void 0===r?void 0:r.contains("react-flow__pane"))||a&&a.target instanceof Element&&a.target.closest(".react-flow__pane"))&&a){let r,n;let{sourceNodeId:s,handleType:i}=function(e){let[t,a]=e.split("-");return{sourceNodeId:t,handleType:a}}(g.current);if(!e.find(e=>e.id===s))return;a instanceof TouchEvent&&a.changedTouches.length>0?(r=a.changedTouches[0].clientX,n=a.changedTouches[0].clientY):(r=a.clientX,n=a.clientY);let c=eI(p,{x:(o=f({x:r,y:n})).x-w/2,y:o.y-j/2},{onLabelChange:v,onVariableNameChange:C,onShapeTypeChange:k,onDelete:E});t(e=>e.concat(c));let d=(l=p.toString(),{id:"".concat(s,"-").concat(l),type:"editableEdge",source:"source"===i?s:l,target:"source"===i?l:s,data:{label:"",arrowType:"arrow",onLabelChange:S,onArrowTypeChange:F,onDelete:T}});u(e=>[...e,d]),x(p+1)}g.current=null}},[p,t,u,f,v,C,k,E,S,F,T,e,w,j]),D=(0,i.useCallback)(()=>{let e=eI(p,{x:500*Math.random(),y:500*Math.random()},{onLabelChange:v,onVariableNameChange:C,onShapeTypeChange:k,onDelete:E});t(t=>t.concat(e)),x(p+1)},[p,t,v,C,k,E]),_=(0,i.useCallback)(e=>{let a=((e,t)=>{let a=new Set(t.map(e=>e.target)),r=e.filter(e=>!a.has(e.id)),n=new Map,o=new Set,l=function(e){var a;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(o.has(e))return;o.add(e);let s=null!==(a=n.get(e))&&void 0!==a?a:0;n.set(e,Math.max(s,r)),t.filter(t=>t.source===e).forEach(e=>{l(e.target,r+1)})};r.forEach(e=>l(e.id,0)),e.forEach(e=>{n.has(e.id)||n.set(e.id,0)});let s=new Map;n.forEach((e,t)=>{s.has(e)||s.set(e,[]),s.get(e).push(t)});let i=new Map;return s.forEach((e,t)=>{let a=-(e.length*eL.NODE_SPACING)/2;e.forEach((e,r)=>{i.set(e,{x:a+r*eL.NODE_SPACING+eL.CENTER_OFFSET,y:t*eL.LEVEL_HEIGHT+eL.VERTICAL_OFFSET})})}),i})(e.nodes,e.edges),r=e.nodes.map(e=>({id:e.id,type:"editableNode",position:a.get(e.id)||{x:250,y:50},data:{label:e.label,variableName:e.variableName,shapeType:e.shapeType,onLabelChange:v,onVariableNameChange:C,onShapeTypeChange:k,onDelete:E}})),n=e.edges.map(e=>({id:e.id,source:e.source,target:e.target,type:"editableEdge",data:{label:e.label,arrowType:e.arrowType,onLabelChange:S,onArrowTypeChange:F,onDelete:T}}));t(r),u(n),x(e.nodes.length+1)},[t,u,v,C,k,E,S,F,T]);return(0,r.jsx)(s.x,{h:"100vh",w:"full",children:(0,r.jsx)(n.ReactFlow,{nodes:e,edges:d,onNodesChange:a,onEdgesChange:h,onConnect:N,onConnectStart:z,onConnectEnd:A,nodeTypes:el,edgeTypes:Z,fitView:!0,children:(0,r.jsx)(c.f,{children:(0,r.jsx)(eR,{onAddNode:D,onImportMermaid:_,nodes:e,edges:d})})})})}},59348:function(e,t,a){"use strict";a.d(t,{C:function(){return s}});var r=a(71082),n=a(88614),o=a(11763),l=a(48983),s=(0,n.forwardRef)((e,t)=>{let{className:a,...s}=e,{styles:i}=(0,r.H9)(),c={...i.divider,...i.separator};return(0,l.jsx)(n.ui.hr,{ref:t,className:(0,o.cx)("ui-menu__separator",a),__css:c,...s})});s.displayName="MenuSeparator",s.__ui__="MenuSeparator"}}]);