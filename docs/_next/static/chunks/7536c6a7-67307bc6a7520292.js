"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{5301:function(t,e,n){n.d(e,{$i:function(){return ts},AL:function(){return tx},B1:function(){return t6},BT:function(){return t9},Cz:function(){return ez},Eg:function(){return D},FD:function(){return ea},Hm:function(){return tZ},IY:function(){return c},J$:function(){return to},J3:function(){return L},JU:function(){return tX},Ki:function(){return tl},Kl:function(){return em},Ky:function(){return H},Kz:function(){return tV},Ly:function(){return y},N5:function(){return tI},OL:function(){return tp},OQ:function(){return tB},OW:function(){return tD},PS:function(){return $},Pp:function(){return tk},Q5:function(){return tc},QZ:function(){return v},Qj:function(){return E},Ql:function(){return eu},RX:function(){return Z},RY:function(){return tT},Rf:function(){return tf},S2:function(){return tM},VV:function(){return t0},Vt:function(){return T},W0:function(){return C},WD:function(){return X},WI:function(){return B},X6:function(){return eg},Z:function(){return P},ZB:function(){return ty},ZJ:function(){return tJ},Z_:function(){return t_},Zp:function(){return k},_2:function(){return tr},be:function(){return t8},dW:function(){return tj},dw:function(){return ex},f5:function(){return Y},hO:function(){return t4},jD:function(){return s},k5:function(){return I},kE:function(){return ti},lM:function(){return tH},lp:function(){return tn},m:function(){return tu},my:function(){return O},n3:function(){return tQ},nb:function(){return tv},nu:function(){return tg},oC:function(){return en},oI:function(){return te},oW:function(){return h},oj:function(){return ta},pB:function(){return p},q7:function(){return F},s$:function(){return tE},so:function(){return t5},t8:function(){return f},t_:function(){return tw},tj:function(){return A},vG:function(){return _},wQ:function(){return z},wv:function(){return tz},xA:function(){return R},xx:function(){return tL},yF:function(){return t1}});var o,i,l,r,u,a,d,s,c,h,f,v,y,p,g=n(88601),x=n(79986),m=n(57613),w=n(35431),M=n(14012),b=n(8859);let E={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>'Node type "'.concat(t,'" not found. Using fallback type "default".'),error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>"The old edge with id=".concat(t," does not exist."),error009:t=>'Marker type "'.concat(t,"\" doesn't exist."),error008:(t,e)=>{let{id:n,sourceHandle:o,targetHandle:i}=e;return"Couldn't create edge for ".concat(t,' handle id: "').concat("source"===t?o:i,'", edge id: ').concat(n,".")},error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>'Edge type "'.concat(t,'" not found. Using fallback type "default".'),error012:t=>'Node with id "'.concat(t,'" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.'),error013:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"It seems that you haven't loaded the styles. Please import '@xyflow/".concat(t,"/dist/style.css' or base.css to make sure everything is working properly.")},error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},I=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],z=["Enter"," ","Escape"],P={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":t=>{let{direction:e,x:n,y:o}=t;return"Moved selected node ".concat(e,". New position, x: ").concat(n,", y: ").concat(o)},"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};(o=s||(s={})).Strict="strict",o.Loose="loose",(i=c||(c={})).Free="free",i.Vertical="vertical",i.Horizontal="horizontal",(l=h||(h={})).Partial="partial",l.Full="full";let H={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};(r=f||(f={})).Bezier="default",r.Straight="straight",r.Step="step",r.SmoothStep="smoothstep",r.SimpleBezier="simplebezier",(u=v||(v={})).Arrow="arrow",u.ArrowClosed="arrowclosed",(a=y||(y={})).Left="left",a.Top="top",a.Right="right",a.Bottom="bottom";let N={[y.Left]:y.Right,[y.Right]:y.Left,[y.Top]:y.Bottom,[y.Bottom]:y.Top};function A(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(let n of t.keys())if(!e.has(n))return!1;return!0}function B(t,e,n){if(!n)return;let o=[];t.forEach((t,n)=>{(null==e?void 0:e.has(n))||o.push(t)}),o.length&&n(o)}function k(t){return null===t?null:t?"valid":"invalid"}let L=t=>"id"in t&&"source"in t&&"target"in t,T=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),S=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),R=(t,e,n)=>{if(!t.id)return[];let o=new Set;return n.forEach(e=>{e.source===t.id&&o.add(e.target)}),e.filter(t=>o.has(t.id))},_=(t,e,n)=>{if(!t.id)return[];let o=new Set;return n.forEach(e=>{e.target===t.id&&o.add(e.source)}),e.filter(t=>o.has(t.id))},V=function(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{width:o,height:i}=tf(t),l=null!==(e=t.origin)&&void 0!==e?e:n,r=o*l[0],u=i*l[1];return{x:t.position.x-r,y:t.position.y-u}},Z=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{nodeOrigin:[0,0]};return 0===t.length?{x:0,y:0,width:0,height:0}:G(t.reduce((t,n)=>{let o="string"==typeof n,i=e.nodeLookup||o?void 0:n;return e.nodeLookup&&(i=o?e.nodeLookup.get(n):S(n)?n:e.nodeLookup.get(n.id)),J(t,i?tt(i,e.nodeOrigin):{x:0,y:0,x2:0,y2:0})},{x:1/0,y:1/0,x2:-1/0,y2:-1/0}))},C=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===t.size)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return t.forEach(t=>{if(void 0===e.filter||e.filter(t)){let e=tt(t);n=J(n,e)}}),G(n)},Y=function(t,e){let[n,o,i]=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,1],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u={...tu(e,[n,o,i]),width:e.width/i,height:e.height/i},a=[];for(let e of t.values()){var d,s,c,h,f,v;let{measured:t,selectable:n=!0,hidden:o=!1}=e;if(r&&!n||o)continue;let i=null!==(c=null!==(s=null!==(d=t.width)&&void 0!==d?d:e.width)&&void 0!==s?s:e.initialWidth)&&void 0!==c?c:null,y=null!==(v=null!==(f=null!==(h=t.height)&&void 0!==h?h:e.height)&&void 0!==f?f:e.initialHeight)&&void 0!==v?v:null,p=tn(u,$(e)),g=(null!=i?i:0)*(null!=y?y:0),x=l&&p>0;(!e.internals.handleBounds||x||p>=g||e.dragging)&&a.push(e)}return a},O=(t,e)=>{let n=new Set;return t.forEach(t=>{n.add(t.id)}),e.filter(t=>n.has(t.source)||n.has(t.target))};async function D(t,e){var n,o,i;let{nodes:l,width:r,height:u,panZoom:a,minZoom:d,maxZoom:s}=t;if(0===l.size)return Promise.resolve(!0);let c=ts(C(function(t,e){let n=new Map,o=(null==e?void 0:e.nodes)?new Set(e.nodes.map(t=>t.id)):null;return t.forEach(t=>{t.measured.width&&t.measured.height&&((null==e?void 0:e.includeHiddenNodes)||!t.hidden)&&(!o||o.has(t.id))&&n.set(t.id,t)}),n}(l,e)),r,u,null!==(n=null==e?void 0:e.minZoom)&&void 0!==n?n:d,null!==(o=null==e?void 0:e.maxZoom)&&void 0!==o?o:s,null!==(i=null==e?void 0:e.padding)&&void 0!==i?i:.1);return await a.setViewport(c,{duration:null==e?void 0:e.duration,ease:null==e?void 0:e.ease,interpolate:null==e?void 0:e.interpolate}),Promise.resolve(!0)}function F(t){var e,n,o;let{nodeId:i,nextPosition:l,nodeLookup:r,nodeOrigin:u=[0,0],nodeExtent:a,onError:d}=t,s=r.get(i),c=s.parentId?r.get(s.parentId):void 0,{x:h,y:f}=c?c.internals.positionAbsolute:{x:0,y:0},v=null!==(e=s.origin)&&void 0!==e?e:u,y=s.extent||a;if("parent"!==s.extent||s.expandParent)c&&th(s.extent)&&(y=[[s.extent[0][0]+h,s.extent[0][1]+f],[s.extent[1][0]+h,s.extent[1][1]+f]]);else if(c){let t=c.measured.width,e=c.measured.height;t&&e&&(y=[[h,f],[h+t,f+e]])}else null==d||d("005",E.error005());let p=th(y)?q(l,y,s.measured):l;return(void 0===s.measured.width||void 0===s.measured.height)&&(null==d||d("015",E.error015())),{position:{x:p.x-h+(null!==(n=s.measured.width)&&void 0!==n?n:0)*v[0],y:p.y-f+(null!==(o=s.measured.height)&&void 0!==o?o:0)*v[1]},positionAbsolute:p}}async function X(t){let{nodesToRemove:e=[],edgesToRemove:n=[],nodes:o,edges:i,onBeforeDelete:l}=t,r=new Set(e.map(t=>t.id)),u=[];for(let t of o){if(!1===t.deletable)continue;let e=r.has(t.id),n=!e&&t.parentId&&u.find(e=>e.id===t.parentId);(e||n)&&u.push(t)}let a=new Set(n.map(t=>t.id)),d=i.filter(t=>!1!==t.deletable),s=O(u,d);for(let t of d)a.has(t.id)&&!s.find(e=>e.id===t.id)&&s.push(t);if(!l)return{edges:s,nodes:u};let c=await l({nodes:u,edges:s});return"boolean"==typeof c?c?{edges:s,nodes:u}:{edges:[],nodes:[]}:c}let W=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)},q=function(){var t,e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return{x:W(n.x,o[0][0],o[1][0]-(null!==(t=null==i?void 0:i.width)&&void 0!==t?t:0)),y:W(n.y,o[0][1],o[1][1]-(null!==(e=null==i?void 0:i.height)&&void 0!==e?e:0))}};function K(t,e,n){let{width:o,height:i}=tf(n),{x:l,y:r}=n.internals.positionAbsolute;return q(t,[[l,r],[l+o,r+i]],e)}let j=(t,e,n)=>t<e?W(Math.abs(t-e),1,e)/e:t>n?-W(Math.abs(t-n),1,e)/e:0,Q=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return[j(t.x,o,e.width-o)*n,j(t.y,o,e.height-o)*n]},J=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),U=t=>{let{x:e,y:n,width:o,height:i}=t;return{x:e,y:n,x2:e+o,y2:n+i}},G=t=>{let{x:e,y:n,x2:o,y2:i}=t;return{x:e,y:n,width:o-e,height:i-n}},$=function(t){var e,n,o,i,l,r,u,a;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=S(t)?t.internals.positionAbsolute:V(t,d);return{x:s,y:c,width:null!==(l=null!==(i=null!==(o=null===(e=t.measured)||void 0===e?void 0:e.width)&&void 0!==o?o:t.width)&&void 0!==i?i:t.initialWidth)&&void 0!==l?l:0,height:null!==(a=null!==(u=null!==(r=null===(n=t.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:t.height)&&void 0!==u?u:t.initialHeight)&&void 0!==a?a:0}},tt=function(t){var e,n,o,i,l,r,u,a;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],{x:s,y:c}=S(t)?t.internals.positionAbsolute:V(t,d);return{x:s,y:c,x2:s+(null!==(l=null!==(i=null!==(o=null===(e=t.measured)||void 0===e?void 0:e.width)&&void 0!==o?o:t.width)&&void 0!==i?i:t.initialWidth)&&void 0!==l?l:0),y2:c+(null!==(a=null!==(u=null!==(r=null===(n=t.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:t.height)&&void 0!==u?u:t.initialHeight)&&void 0!==a?a:0)}},te=(t,e)=>G(J(U(t),U(e))),tn=(t,e)=>Math.ceil(Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x))*Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y))),to=t=>ti(t.width)&&ti(t.height)&&ti(t.x)&&ti(t.y),ti=t=>!isNaN(t)&&isFinite(t),tl=(t,e)=>{},tr=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1];return{x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}},tu=function(t,e){let{x:n,y:o}=t,[i,l,r]=e,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],d={x:(n-i)/r,y:(o-l)/r};return u?tr(d,a):d},ta=(t,e)=>{let{x:n,y:o}=t,[i,l,r]=e;return{x:n*r+i,y:o*r+l}};function td(t,e){if("number"==typeof t)return Math.floor((e-e/(1+t))*.5);if("string"==typeof t&&t.endsWith("px")){let e=parseFloat(t);if(!Number.isNaN(e))return Math.floor(e)}if("string"==typeof t&&t.endsWith("%")){let n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error('[React Flow] The padding value "'.concat(t,'" is invalid. Please provide a number or a string with a valid unit (px or %).')),0}let ts=(t,e,n,o,i,l)=>{let r=function(t,e,n){if("string"==typeof t||"number"==typeof t){let o=td(t,n),i=td(t,e);return{top:o,right:i,bottom:o,left:i,x:2*i,y:2*o}}if("object"==typeof t){var o,i,l,r,u,a,d,s;let c=td(null!==(i=null!==(o=t.top)&&void 0!==o?o:t.y)&&void 0!==i?i:0,n),h=td(null!==(r=null!==(l=t.bottom)&&void 0!==l?l:t.y)&&void 0!==r?r:0,n),f=td(null!==(a=null!==(u=t.left)&&void 0!==u?u:t.x)&&void 0!==a?a:0,e),v=td(null!==(s=null!==(d=t.right)&&void 0!==d?d:t.x)&&void 0!==s?s:0,e);return{top:c,right:v,bottom:h,left:f,x:f+v,y:c+h}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(l,e,n),u=W(Math.min((e-r.x)/t.width,(n-r.y)/t.height),o,i),a=t.x+t.width/2,d=t.y+t.height/2,s=e/2-a*u,c=n/2-d*u,h=function(t,e,n,o,i,l){let{x:r,y:u}=ta(t,[e,n,o]),{x:a,y:d}=ta({x:t.x+t.width,y:t.y+t.height},[e,n,o]);return{left:Math.floor(r),top:Math.floor(u),right:Math.floor(i-a),bottom:Math.floor(l-d)}}(t,s,c,u,e,n),f={left:Math.min(h.left-r.left,0),top:Math.min(h.top-r.top,0),right:Math.min(h.right-r.right,0),bottom:Math.min(h.bottom-r.bottom,0)};return{x:s-f.left+f.right,y:c-f.top+f.bottom,zoom:u}},tc=()=>{var t,e;return"undefined"!=typeof navigator&&(null===(e=navigator)||void 0===e?void 0:null===(t=e.userAgent)||void 0===t?void 0:t.indexOf("Mac"))>=0};function th(t){return void 0!==t&&"parent"!==t}function tf(t){var e,n,o,i,l,r,u,a;return{width:null!==(l=null!==(i=null!==(o=null===(e=t.measured)||void 0===e?void 0:e.width)&&void 0!==o?o:t.width)&&void 0!==i?i:t.initialWidth)&&void 0!==l?l:0,height:null!==(a=null!==(u=null!==(r=null===(n=t.measured)||void 0===n?void 0:n.height)&&void 0!==r?r:t.height)&&void 0!==u?u:t.initialHeight)&&void 0!==a?a:0}}function tv(t){var e,n,o,i,l,r;return(null!==(i=null!==(o=null===(e=t.measured)||void 0===e?void 0:e.width)&&void 0!==o?o:t.width)&&void 0!==i?i:t.initialWidth)!==void 0&&(null!==(r=null!==(l=null===(n=t.measured)||void 0===n?void 0:n.height)&&void 0!==l?l:t.height)&&void 0!==r?r:t.initialHeight)!==void 0}function ty(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l={...t},r=o.get(n);if(r){var u,a;let t=r.origin||i;l.x+=r.internals.positionAbsolute.x-(null!==(u=e.width)&&void 0!==u?u:0)*t[0],l.y+=r.internals.positionAbsolute.y-(null!==(a=e.height)&&void 0!==a?a:0)*t[1]}return l}function tp(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function tg(){let t,e;return{promise:new Promise((n,o)=>{t=n,e=o}),resolve:t,reject:e}}function tx(t){return{...P,...t||{}}}function tm(t,e){var n,o;let{snapGrid:i=[0,0],snapToGrid:l=!1,transform:r,containerBounds:u}=e,{x:a,y:d}=tz(t),s=tu({x:a-(null!==(n=null==u?void 0:u.left)&&void 0!==n?n:0),y:d-(null!==(o=null==u?void 0:u.top)&&void 0!==o?o:0)},r),{x:c,y:h}=l?tr(s,i):s;return{xSnapped:c,ySnapped:h,...s}}let tw=t=>({width:t.offsetWidth,height:t.offsetHeight}),tM=t=>{var e,n;return(null==t?void 0:null===(e=t.getRootNode)||void 0===e?void 0:e.call(t))||(null===(n=window)||void 0===n?void 0:n.document)},tb=["INPUT","SELECT","TEXTAREA"];function tE(t){var e,n;let o=(null===(n=t.composedPath)||void 0===n?void 0:null===(e=n.call(t))||void 0===e?void 0:e[0])||t.target;return(null==o?void 0:o.nodeType)===1&&(tb.includes(o.nodeName)||o.hasAttribute("contenteditable")||!!o.closest(".nokey"))}let tI=t=>"clientX"in t,tz=(t,e)=>{var n,o,i,l;let r=tI(t),u=r?t.clientX:null===(n=t.touches)||void 0===n?void 0:n[0].clientX,a=r?t.clientY:null===(o=t.touches)||void 0===o?void 0:o[0].clientY;return{x:u-(null!==(i=null==e?void 0:e.left)&&void 0!==i?i:0),y:a-(null!==(l=null==e?void 0:e.top)&&void 0!==l?l:0)}},tP=(t,e,n,o,i)=>{let l=e.querySelectorAll(".".concat(t));return l&&l.length?Array.from(l).map(e=>{let l=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),type:t,nodeId:i,position:e.getAttribute("data-handlepos"),x:(l.left-n.left)/o,y:(l.top-n.top)/o,...tw(e)}}):null};function tH(t){let{sourceX:e,sourceY:n,targetX:o,targetY:i,sourceControlX:l,sourceControlY:r,targetControlX:u,targetControlY:a}=t,d=.125*e+.375*l+.375*u+.125*o,s=.125*n+.375*r+.375*a+.125*i;return[d,s,Math.abs(d-e),Math.abs(s-n)]}function tN(t,e){return t>=0?.5*t:25*e*Math.sqrt(-t)}function tA(t){let{pos:e,x1:n,y1:o,x2:i,y2:l,c:r}=t;switch(e){case y.Left:return[n-tN(n-i,r),o];case y.Right:return[n+tN(i-n,r),o];case y.Top:return[n,o-tN(o-l,r)];case y.Bottom:return[n,o+tN(l-o,r)]}}function tB(t){let{sourceX:e,sourceY:n,sourcePosition:o=y.Bottom,targetX:i,targetY:l,targetPosition:r=y.Top,curvature:u=.25}=t,[a,d]=tA({pos:o,x1:e,y1:n,x2:i,y2:l,c:u}),[s,c]=tA({pos:r,x1:i,y1:l,x2:e,y2:n,c:u}),[h,f,v,p]=tH({sourceX:e,sourceY:n,targetX:i,targetY:l,sourceControlX:a,sourceControlY:d,targetControlX:s,targetControlY:c});return["M".concat(e,",").concat(n," C").concat(a,",").concat(d," ").concat(s,",").concat(c," ").concat(i,",").concat(l),h,f,v,p]}function tk(t){let{sourceX:e,sourceY:n,targetX:o,targetY:i}=t,l=Math.abs(o-e)/2,r=Math.abs(i-n)/2;return[o<e?o+l:o-l,i<n?i+r:i-r,l,r]}function tL(t){let{sourceNode:e,targetNode:n,selected:o=!1,zIndex:i,elevateOnSelect:l=!1}=t;return void 0!==i?i:(l&&o?1e3:0)+Math.max(e.parentId?e.internals.z:0,n.parentId?n.internals.z:0)}function tT(t){let{sourceNode:e,targetNode:n,width:o,height:i,transform:l}=t,r=J(tt(e),tt(n));return r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1),tn({x:-l[0]/l[2],y:-l[1]/l[2],width:o/l[2],height:i/l[2]},G(r))>0}let tS=t=>{let{source:e,sourceHandle:n,target:o,targetHandle:i}=t;return"xy-edge__".concat(e).concat(n||"","-").concat(o).concat(i||"")},tR=(t,e)=>e.some(e=>e.source===t.source&&e.target===t.target&&(e.sourceHandle===t.sourceHandle||!e.sourceHandle&&!t.sourceHandle)&&(e.targetHandle===t.targetHandle||!e.targetHandle&&!t.targetHandle)),t_=(t,e)=>{let n;return t.source&&t.target?tR(n=L(t)?{...t}:{...t,id:tS(t)},e)?e:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,e.concat(n)):(tl("006",E.error006()),e)},tV=function(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{shouldReplaceId:!0},{id:i,...l}=t;if(!e.source||!e.target)return tl("006",E.error006()),n;if(!n.find(e=>e.id===t.id))return tl("007",E.error007(i)),n;let r={...l,id:o.shouldReplaceId?tS(e):i,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle};return n.filter(t=>t.id!==i).concat(r)};function tZ(t){let{sourceX:e,sourceY:n,targetX:o,targetY:i}=t,[l,r,u,a]=tk({sourceX:e,sourceY:n,targetX:o,targetY:i});return["M ".concat(e,",").concat(n,"L ").concat(o,",").concat(i),l,r,u,a]}let tC={[y.Left]:{x:-1,y:0},[y.Right]:{x:1,y:0},[y.Top]:{x:0,y:-1},[y.Bottom]:{x:0,y:1}},tY=t=>{let{source:e,sourcePosition:n=y.Bottom,target:o}=t;return n===y.Left||n===y.Right?e.x<o.x?{x:1,y:0}:{x:-1,y:0}:e.y<o.y?{x:0,y:1}:{x:0,y:-1}},tO=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function tD(t){let{sourceX:e,sourceY:n,sourcePosition:o=y.Bottom,targetX:i,targetY:l,targetPosition:r=y.Top,borderRadius:u=5,centerX:a,centerY:d,offset:s=20,stepPosition:c=.5}=t,[h,f,v,p,g]=function(t){let e,n,{source:o,sourcePosition:i=y.Bottom,target:l,targetPosition:r=y.Top,center:u,offset:a,stepPosition:d}=t,s=tC[i],c=tC[r],h={x:o.x+s.x*a,y:o.y+s.y*a},f={x:l.x+c.x*a,y:l.y+c.y*a},v=tY({source:h,sourcePosition:i,target:f}),p=0!==v.x?"x":"y",g=v[p],x=[],m={x:0,y:0},w={x:0,y:0},[,,M,b]=tk({sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y});if(s[p]*c[p]==-1){var E,I,z,P;"x"===p?(e=null!==(E=u.x)&&void 0!==E?E:h.x+(f.x-h.x)*d,n=null!==(I=u.y)&&void 0!==I?I:(h.y+f.y)/2):(e=null!==(z=u.x)&&void 0!==z?z:(h.x+f.x)/2,n=null!==(P=u.y)&&void 0!==P?P:h.y+(f.y-h.y)*d);let t=[{x:e,y:h.y},{x:e,y:f.y}],o=[{x:h.x,y:n},{x:f.x,y:n}];x=s[p]===g?"x"===p?t:o:"x"===p?o:t}else{let t=[{x:h.x,y:f.y}],u=[{x:f.x,y:h.y}];if(x="x"===p?s.x===g?u:t:s.y===g?t:u,i===r){let t=Math.abs(o[p]-l[p]);if(t<=a){let e=Math.min(a-1,a-t);s[p]===g?m[p]=(h[p]>o[p]?-1:1)*e:w[p]=(f[p]>l[p]?-1:1)*e}}if(i!==r){let e="x"===p?"y":"x",n=s[p]===c[e],o=h[e]>f[e],i=h[e]<f[e];(1===s[p]&&(!n&&o||n&&i)||1!==s[p]&&(!n&&i||n&&o))&&(x="x"===p?t:u)}let d={x:h.x+m.x,y:h.y+m.y},v={x:f.x+w.x,y:f.y+w.y};Math.max(Math.abs(d.x-x[0].x),Math.abs(v.x-x[0].x))>=Math.max(Math.abs(d.y-x[0].y),Math.abs(v.y-x[0].y))?(e=(d.x+v.x)/2,n=x[0].y):(e=x[0].x,n=(d.y+v.y)/2)}return[[o,{x:h.x+m.x,y:h.y+m.y},...x,{x:f.x+w.x,y:f.y+w.y},l],e,n,M,b]}({source:{x:e,y:n},sourcePosition:o,target:{x:i,y:l},targetPosition:r,center:{x:a,y:d},offset:s,stepPosition:c});return[h.reduce((t,e,n)=>t+(n>0&&n<h.length-1?function(t,e,n,o){let i=Math.min(tO(t,e)/2,tO(e,n)/2,o),{x:l,y:r}=e;if(t.x===l&&l===n.x||t.y===r&&r===n.y)return"L".concat(l," ").concat(r);if(t.y===r){let e=t.x<n.x?-1:1,o=t.y<n.y?1:-1;return"L ".concat(l+i*e,",").concat(r,"Q ").concat(l,",").concat(r," ").concat(l,",").concat(r+i*o)}let u=t.x<n.x?1:-1,a=t.y<n.y?-1:1;return"L ".concat(l,",").concat(r+i*a,"Q ").concat(l,",").concat(r," ").concat(l+i*u,",").concat(r)}(h[n-1],e,h[n+1],u):"".concat(0===n?"M":"L").concat(e.x," ").concat(e.y)),""),f,v,p,g]}function tF(t){var e;return t&&!!(t.internals.handleBounds||(null===(e=t.handles)||void 0===e?void 0:e.length))&&!!(t.measured.width||t.width||t.initialWidth)}function tX(t){var e,n,o,i,l;let{sourceNode:r,targetNode:u}=t;if(!tF(r)||!tF(u))return null;let a=r.internals.handleBounds||tW(r.handles),d=u.internals.handleBounds||tW(u.handles),c=tK(null!==(e=null==a?void 0:a.source)&&void 0!==e?e:[],t.sourceHandle),h=tK(t.connectionMode===s.Strict?null!==(n=null==d?void 0:d.target)&&void 0!==n?n:[]:(null!==(o=null==d?void 0:d.target)&&void 0!==o?o:[]).concat(null!==(i=null==d?void 0:d.source)&&void 0!==i?i:[]),t.targetHandle);if(!c||!h)return null===(l=t.onError)||void 0===l||l.call(t,"008",E.error008(c?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;let f=(null==c?void 0:c.position)||y.Bottom,v=(null==h?void 0:h.position)||y.Top,p=tq(r,c,f),g=tq(u,h,v);return{sourceX:p.x,sourceY:p.y,targetX:g.x,targetY:g.y,sourcePosition:f,targetPosition:v}}function tW(t){if(!t)return null;let e=[],n=[];for(let l of t){var o,i;l.width=null!==(o=l.width)&&void 0!==o?o:1,l.height=null!==(i=l.height)&&void 0!==i?i:1,"source"===l.type?e.push(l):"target"===l.type&&n.push(l)}return{source:e,target:n}}function tq(t,e){var n,o,i;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.Left,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(null!==(n=null==e?void 0:e.x)&&void 0!==n?n:0)+t.internals.positionAbsolute.x,a=(null!==(o=null==e?void 0:e.y)&&void 0!==o?o:0)+t.internals.positionAbsolute.y,{width:d,height:s}=null!=e?e:tf(t);if(r)return{x:u+d/2,y:a+s/2};switch(null!==(i=null==e?void 0:e.position)&&void 0!==i?i:l){case y.Top:return{x:u+d/2,y:a};case y.Right:return{x:u+d,y:a+s/2};case y.Bottom:return{x:u+d/2,y:a+s};case y.Left:return{x:u,y:a+s/2}}}function tK(t,e){return t&&(e?t.find(t=>t.id===e):t[0])||null}function tj(t,e){return t?"string"==typeof t?t:"".concat(e?"".concat(e,"__"):"").concat(Object.keys(t).sort().map(e=>"".concat(e,"=").concat(t[e])).join("&")):""}function tQ(t,e){let{id:n,defaultColor:o,defaultMarkerStart:i,defaultMarkerEnd:l}=e,r=new Set;return t.reduce((t,e)=>([e.markerStart||i,e.markerEnd||l].forEach(e=>{if(e&&"object"==typeof e){let i=tj(e,n);r.has(i)||(t.push({id:i,color:e.color||o,...e}),r.add(i))}}),t),[]).sort((t,e)=>t.id.localeCompare(e.id))}function tJ(t,e,n,o,i){let l=.5;"start"===i?l=0:"end"===i&&(l=1);let r=[(t.x+t.width*l)*e.zoom+e.x,t.y*e.zoom+e.y-o],u=[-100*l,-100];switch(n){case y.Right:r=[(t.x+t.width)*e.zoom+e.x+o,(t.y+t.height*l)*e.zoom+e.y],u=[0,-100*l];break;case y.Bottom:r[1]=(t.y+t.height)*e.zoom+e.y+o,u[1]=0;break;case y.Left:r=[t.x*e.zoom+e.x-o,(t.y+t.height*l)*e.zoom+e.y],u=[-100,-100*l]}return"translate(".concat(r[0],"px, ").concat(r[1],"px) translate(").concat(u[0],"%, ").concat(u[1],"%)")}let tU={nodeOrigin:[0,0],nodeExtent:I,elevateNodesOnSelect:!0,defaults:{}},tG={...tU,checkEquality:!0};function t$(t,e){let n={...t};for(let t in e)void 0!==e[t]&&(n[t]=e[t]);return n}function t0(t,e,n){let o=t$(tU,n);for(let n of t.values())if(n.parentId)t2(n,t,e,o);else{let t=q(V(n,o.nodeOrigin),th(n.extent)?n.extent:o.nodeExtent,tf(n));n.internals.positionAbsolute=t}}function t1(t,e,n,o){let i=t$(tG,o),l=t.length>0,r=new Map(e),u=(null==i?void 0:i.elevateNodesOnSelect)?1e3:0;for(let s of(e.clear(),n.clear(),t)){let t=r.get(s.id);if(i.checkEquality&&s===(null==t?void 0:t.internals.userNode))e.set(s.id,t);else{var a,d;let n=q(V(s,i.nodeOrigin),th(s.extent)?s.extent:i.nodeExtent,tf(s));t={...i.defaults,...s,measured:{width:null===(a=s.measured)||void 0===a?void 0:a.width,height:null===(d=s.measured)||void 0===d?void 0:d.height},internals:{positionAbsolute:n,handleBounds:s.measured?null==t?void 0:t.internals.handleBounds:void 0,z:t3(s,u),userNode:s}},e.set(s.id,t)}void 0!==t.measured&&void 0!==t.measured.width&&void 0!==t.measured.height||t.hidden||(l=!1),s.parentId&&t2(t,e,n,o)}return l}function t2(t,e,n,o){let{elevateNodesOnSelect:i,nodeOrigin:l,nodeExtent:r}=t$(tU,o),u=t.parentId,a=e.get(u);if(!a){console.warn("Parent node ".concat(u," not found. Please make sure that parent nodes are in front of their child nodes in the nodes array."));return}!function(t,e){if(!t.parentId)return;let n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}(t,n);let{x:d,y:s,z:c}=function(t,e,n,o,i){var l;let{x:r,y:u}=e.internals.positionAbsolute,a=tf(t),d=V(t,n),s=th(t.extent)?q(d,t.extent,a):d,c=q({x:r+s.x,y:u+s.y},o,a);"parent"===t.extent&&(c=K(c,a,e));let h=t3(t,i),f=null!==(l=e.internals.z)&&void 0!==l?l:0;return{x:c.x,y:c.y,z:f>=h?f+1:h}}(t,a,l,r,i?1e3:0),{positionAbsolute:h}=t.internals,f=d!==h.x||s!==h.y;(f||c!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:f?{x:d,y:s}:h,z:c}})}function t3(t,e){return(ti(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function t5(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],i=[],l=new Map;for(let n of t){var r,u;let t=e.get(n.parentId);if(!t)continue;let o=te(null!==(u=null===(r=l.get(n.parentId))||void 0===r?void 0:r.expandedRect)&&void 0!==u?u:$(t),n.rect);l.set(n.parentId,{expandedRect:o,parent:t})}return l.size>0&&l.forEach((e,l)=>{var r,u;let{expandedRect:a,parent:d}=e,s=d.internals.positionAbsolute,c=tf(d),h=null!==(r=d.origin)&&void 0!==r?r:o,f=a.x<s.x?Math.round(Math.abs(s.x-a.x)):0,v=a.y<s.y?Math.round(Math.abs(s.y-a.y)):0,y=Math.max(c.width,Math.round(a.width)),p=Math.max(c.height,Math.round(a.height)),g=(y-c.width)*h[0],x=(p-c.height)*h[1];(f>0||v>0||g||x)&&(i.push({id:l,type:"position",position:{x:d.position.x-f+g,y:d.position.y-v+x}}),null===(u=n.get(l))||void 0===u||u.forEach(e=>{t.some(t=>t.id===e.id)||i.push({id:e.id,type:"position",position:{x:e.position.x+f,y:e.position.y+v}})})),(c.width<a.width||c.height<a.height||f||v)&&i.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:y+(f?h[0]*f-g:0),height:p+(v?h[1]*v-x:0)}})}),i}function t6(t,e,n,o,i,l){let r=null==o?void 0:o.querySelector(".xyflow__viewport"),u=!1;if(!r)return{changes:[],updatedInternals:u};let a=[],d=window.getComputedStyle(r),{m22:s}=new window.DOMMatrixReadOnly(d.transform),c=[];for(let o of t.values()){let t=e.get(o.id);if(!t)continue;if(t.hidden){e.set(t.id,{...t,internals:{...t.internals,handleBounds:void 0}}),u=!0;continue}let r=tw(o.nodeElement),d=t.measured.width!==r.width||t.measured.height!==r.height;if(r.width&&r.height&&(d||!t.internals.handleBounds||o.force)){let h=o.nodeElement.getBoundingClientRect(),f=th(t.extent)?t.extent:l,{positionAbsolute:v}=t.internals;t.parentId&&"parent"===t.extent?v=K(v,r,e.get(t.parentId)):f&&(v=q(v,f,r));let y={...t,measured:r,internals:{...t.internals,positionAbsolute:v,handleBounds:{source:tP("source",o.nodeElement,h,s,t.id),target:tP("target",o.nodeElement,h,s,t.id)}}};e.set(t.id,y),t.parentId&&t2(y,e,n,{nodeOrigin:i}),u=!0,d&&(a.push({id:t.id,type:"dimensions",dimensions:r}),t.expandParent&&t.parentId&&c.push({id:t.id,parentId:t.parentId,rect:$(y,i)}))}}if(c.length>0){let t=t5(c,e,n,i);a.push(...t)}return{changes:a,updatedInternals:u}}async function t4(t){let{delta:e,panZoom:n,transform:o,translateExtent:i,width:l,height:r}=t;if(!n||!e.x&&!e.y)return Promise.resolve(!1);let u=await n.setViewportConstrained({x:o[0]+e.x,y:o[1]+e.y,zoom:o[2]},[[0,0],[l,r]],i);return Promise.resolve(!!u&&(u.x!==o[0]||u.y!==o[1]||u.k!==o[2]))}function t7(t,e,n,o,i,l){let r=i,u=o.get(r)||new Map;o.set(r,u.set(n,e)),r="".concat(i,"-").concat(t);let a=o.get(r)||new Map;if(o.set(r,a.set(n,e)),l){r="".concat(i,"-").concat(t,"-").concat(l);let u=o.get(r)||new Map;o.set(r,u.set(n,e))}}function t8(t,e,n){for(let o of(t.clear(),e.clear(),n)){let{source:n,target:i,sourceHandle:l=null,targetHandle:r=null}=o,u={edgeId:o.id,source:n,target:i,sourceHandle:l,targetHandle:r},a="".concat(n,"-").concat(l,"--").concat(i,"-").concat(r);t7("source",u,"".concat(i,"-").concat(r,"--").concat(n,"-").concat(l),t,n,l),t7("target",u,a,t,i,r),e.set(o.id,o)}}function t9(t,e){if(null===t||null===e)return!1;let n=Array.isArray(t)?t:[t],o=Array.isArray(e)?e:[e];if(n.length!==o.length)return!1;for(let t=0;t<n.length;t++)if(n[t].id!==o[t].id||n[t].type!==o[t].type||!Object.is(n[t].data,o[t].data))return!1;return!0}function et(t,e,n){let o=t;do{var i;if(null==o?void 0:null===(i=o.matches)||void 0===i?void 0:i.call(o,e))return!0;if(o===n)break;o=null==o?void 0:o.parentElement}while(o);return!1}function ee(t){var e,n,o;let{nodeId:i,dragItems:l,nodeLookup:r,dragging:u=!0}=t,a=[];for(let[t,e]of l){let n=null===(o=r.get(t))||void 0===o?void 0:o.internals.userNode;n&&a.push({...n,position:e.position,dragging:u})}if(!i)return[a[0],a];let d=null===(e=r.get(i))||void 0===e?void 0:e.internals.userNode;return[d?{...d,position:(null===(n=l.get(i))||void 0===n?void 0:n.position)||d.position,dragging:u}:a[0],a]}function en(t){let{onNodeMouseDown:e,getStoreItems:n,onDragStart:o,onDrag:i,onDragStop:l}=t,r={x:null,y:null},u=0,a=new Map,d=!1,s={x:0,y:0},c=null,h=!1,f=null,v=!1,y=!1;return{update:function(t){let{noDragClassName:p,handleSelector:m,domNode:w,isSelectable:M,nodeId:b,nodeClickDistance:E=0}=t;function I(t,e){let{x:o,y:l}=t,{nodeLookup:u,nodeExtent:d,snapGrid:s,snapToGrid:c,nodeOrigin:h,onNodeDrag:f,onSelectionDrag:v,onError:p,updateNodePositions:g}=n();r={x:o,y:l};let x=!1,m={x:0,y:0,x2:0,y2:0};for(let[t,e]of(a.size>1&&d&&(m=U(C(a))),a)){if(!u.has(t))continue;let n={x:o-e.distance.x,y:l-e.distance.y};c&&(n=tr(n,s));let i=[[d[0][0],d[0][1]],[d[1][0],d[1][1]]];if(a.size>1&&d&&!e.extent){let{positionAbsolute:t}=e.internals,n=t.x-m.x+d[0][0],o=t.x+e.measured.width-m.x2+d[1][0];i=[[n,t.y-m.y+d[0][1]],[o,t.y+e.measured.height-m.y2+d[1][1]]]}let{position:r,positionAbsolute:f}=F({nodeId:t,nextPosition:n,nodeLookup:u,nodeExtent:i,nodeOrigin:h,onError:p});x=x||e.position.x!==r.x||e.position.y!==r.y,e.position=r,e.internals.positionAbsolute=f}if(y=y||x,x&&(g(a,!0),e&&(i||f||!b&&v))){let[t,n]=ee({nodeId:b,dragItems:a,nodeLookup:u});null==i||i(e,a,t,n),null==f||f(e,t,n),b||null==v||v(e,n)}}async function z(){if(!c)return;let{transform:t,panBy:e,autoPanSpeed:o,autoPanOnNodeDrag:i}=n();if(!i){d=!1,cancelAnimationFrame(u);return}let[l,a]=Q(s,c,o);if(0!==l||0!==a){var h,f;r.x=(null!==(h=r.x)&&void 0!==h?h:0)-l/t[2],r.y=(null!==(f=r.y)&&void 0!==f?f:0)-a/t[2],await e({x:l,y:a})&&I(r,null)}u=requestAnimationFrame(z)}function P(t){let{nodeLookup:i,multiSelectionActive:l,nodesDraggable:u,transform:d,snapGrid:s,snapToGrid:f,selectNodesOnDrag:v,onNodeDragStart:y,onSelectionDragStart:p,unselectNodesAndEdges:g}=n();if(h=!0,(!v||!M)&&!l&&b){var x;(null===(x=i.get(b))||void 0===x?void 0:x.selected)||g()}M&&v&&b&&(null==e||e(b));let m=tm(t.sourceEvent,{transform:d,snapGrid:s,snapToGrid:f,containerBounds:c});if(r=m,(a=function(t,e,n,o){let i=new Map;for(let[u,a]of t)if((a.selected||a.id===o)&&(!a.parentId||!function t(e,n){if(!e.parentId)return!1;let o=n.get(e.parentId);return!!o&&(!!o.selected||t(o,n))}(a,t))&&(a.draggable||e&&void 0===a.draggable)){let e=t.get(u);if(e){var l,r;i.set(u,{id:u,position:e.position||{x:0,y:0},distance:{x:n.x-e.internals.positionAbsolute.x,y:n.y-e.internals.positionAbsolute.y},extent:e.extent,parentId:e.parentId,origin:e.origin,expandParent:e.expandParent,internals:{positionAbsolute:e.internals.positionAbsolute||{x:0,y:0}},measured:{width:null!==(l=e.measured.width)&&void 0!==l?l:0,height:null!==(r=e.measured.height)&&void 0!==r?r:0}})}}return i}(i,u,m,b)).size>0&&(o||y||!b&&p)){let[e,n]=ee({nodeId:b,dragItems:a,nodeLookup:i});null==o||o(t.sourceEvent,a,e,n),null==y||y(t.sourceEvent,e,n),b||null==p||p(t.sourceEvent,n)}}f=(0,x.Z)(w);let H=(0,g.Z)().clickDistance(E).on("start",t=>{let{domNode:e,nodeDragThreshold:o,transform:i,snapGrid:l,snapToGrid:u}=n();c=(null==e?void 0:e.getBoundingClientRect())||null,v=!1,y=!1,0===o&&P(t),r=tm(t.sourceEvent,{transform:i,snapGrid:l,snapToGrid:u,containerBounds:c}),s=tz(t.sourceEvent,c)}).on("drag",t=>{let{autoPanOnNodeDrag:e,transform:o,snapGrid:i,snapToGrid:l,nodeDragThreshold:u,nodeLookup:f}=n(),y=tm(t.sourceEvent,{transform:o,snapGrid:i,snapToGrid:l,containerBounds:c});if(("touchmove"===t.sourceEvent.type&&t.sourceEvent.touches.length>1||b&&!f.has(b))&&(v=!0),!v){if(!d&&e&&h&&(d=!0,z()),!h){var p,g;let e=y.xSnapped-(null!==(p=r.x)&&void 0!==p?p:0),n=y.ySnapped-(null!==(g=r.y)&&void 0!==g?g:0);Math.sqrt(e*e+n*n)>u&&P(t)}(r.x!==y.xSnapped||r.y!==y.ySnapped)&&a&&h&&(s=tz(t.sourceEvent,c),I(y,t.sourceEvent))}}).on("end",t=>{if(h&&!v&&(d=!1,h=!1,cancelAnimationFrame(u),a.size>0)){let{nodeLookup:e,updateNodePositions:o,onNodeDragStop:i,onSelectionDragStop:r}=n();if(y&&(o(a,!1),y=!1),l||i||!b&&r){let[n,o]=ee({nodeId:b,dragItems:a,nodeLookup:e,dragging:!1});null==l||l(t.sourceEvent,a,n,o),null==i||i(t.sourceEvent,n,o),b||null==r||r(t.sourceEvent,o)}}}).filter(t=>{let e=t.target;return!t.button&&(!p||!et(e,".".concat(p),w))&&(!m||et(e,m,w))});f.call(H)},destroy:function(){null==f||f.on(".drag",null)}}}function eo(t,e,n,o,i){var l,r,u,a,d,s;let c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=o.get(t);if(!h)return null;let f="strict"===i?null===(l=h.internals.handleBounds)||void 0===l?void 0:l[e]:[...null!==(a=null===(r=h.internals.handleBounds)||void 0===r?void 0:r.source)&&void 0!==a?a:[],...null!==(d=null===(u=h.internals.handleBounds)||void 0===u?void 0:u.target)&&void 0!==d?d:[]],v=null!==(s=n?null==f?void 0:f.find(t=>t.id===n):null==f?void 0:f[0])&&void 0!==s?s:null;return v&&c?{...v,...tq(h,v,v.position,!0)}:v}function ei(t,e){return t||((null==e?void 0:e.classList.contains("target"))?"target":(null==e?void 0:e.classList.contains("source"))?"source":null)}let el=()=>!0;function er(t,e){let{handle:n,connectionMode:o,fromNodeId:i,fromHandleId:l,fromType:r,doc:u,lib:a,flowId:d,isValidConnection:c=el,nodeLookup:h}=e,f="target"===r,v=n?u.querySelector(".".concat(a,'-flow__handle[data-id="').concat(d,"-").concat(null==n?void 0:n.nodeId,"-").concat(null==n?void 0:n.id,"-").concat(null==n?void 0:n.type,'"]')):null,{x:y,y:p}=tz(t),g=u.elementFromPoint(y,p),x=(null==g?void 0:g.classList.contains("".concat(a,"-flow__handle")))?g:v,m={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){let t=ei(void 0,x),e=x.getAttribute("data-nodeid"),n=x.getAttribute("data-handleid"),r=x.classList.contains("connectable"),u=x.classList.contains("connectableend");if(!e||!t)return m;let a={source:f?e:i,sourceHandle:f?n:l,target:f?i:e,targetHandle:f?l:n};m.connection=a;let d=r&&u&&(o===s.Strict?f&&"source"===t||!f&&"target"===t:e!==i||n!==l);m.isValid=d&&c(a),m.toHandle=eo(e,t,n,h,o,!0)}return m}let eu={onPointerDown:function(t,e){let n,{connectionMode:o,connectionRadius:i,handleId:l,nodeId:r,edgeUpdaterType:u,isTarget:a,domNode:d,nodeLookup:s,lib:c,autoPanOnConnect:h,flowId:f,panBy:v,cancelConnection:p,onConnectStart:g,onConnect:x,onConnectEnd:m,isValidConnection:w=el,onReconnectEnd:M,updateConnection:b,getTransform:E,getFromHandle:I,autoPanSpeed:z,dragThreshold:P=1}=e,H=tM(t.target),A=0,{x:B,y:k}=tz(t),L=ei(u,null==H?void 0:H.elementFromPoint(B,k)),T=null==d?void 0:d.getBoundingClientRect(),S=!1;if(!T||!L)return;let R=eo(r,L,l,s,o);if(!R)return;let _=tz(t,T),V=!1,Z=null,C=!1,Y=null,O={...R,nodeId:r,type:L,position:R.position},D=s.get(r),F={inProgress:!0,isValid:null,from:tq(D,O,y.Left,!0),fromHandle:O,fromPosition:O.position,fromNode:D,to:_,toHandle:null,toPosition:N[O.position],toNode:null};function X(){S=!0,b(F),null==g||g(t,{nodeId:r,handleId:l,handleType:L})}function W(t){var e,u;let d;if(!S){let{x:e,y:n}=tz(t),o=e-B,i=n-k;if(!(o*o+i*i>P*P))return;X()}if(!I()||!O){q(t);return}let y=E();n=function(t,e,n,o){var i,l,r,u,a;let d=[],s=1/0;for(let a of function(t,e,n){let o=[],i={x:t.x-n,y:t.y-n,width:2*n,height:2*n};for(let t of e.values())tn(i,$(t))>0&&o.push(t);return o}(t,n,e+250))for(let n of[...null!==(r=null===(i=a.internals.handleBounds)||void 0===i?void 0:i.source)&&void 0!==r?r:[],...null!==(u=null===(l=a.internals.handleBounds)||void 0===l?void 0:l.target)&&void 0!==u?u:[]]){if(o.nodeId===n.nodeId&&o.type===n.type&&o.id===n.id)continue;let{x:i,y:l}=tq(a,n,n.position,!0),r=Math.sqrt(Math.pow(i-t.x,2)+Math.pow(l-t.y,2));r>e||(r<s?(d=[{...n,x:i,y:l}],s=r):r===s&&d.push({...n,x:i,y:l}))}if(!d.length)return null;if(d.length>1){let t="source"===o.type?"target":"source";return null!==(a=d.find(e=>e.type===t))&&void 0!==a?a:d[0]}return d[0]}(tu(_=tz(t,T),y,!1,[1,1]),i,s,O),V||(function t(){if(!h||!T)return;let[e,n]=Q(_,T,z);v({x:e,y:n}),A=requestAnimationFrame(t)}(),V=!0);let p=er(t,{handle:n,connectionMode:o,fromNodeId:r,fromHandleId:l,fromType:a?"target":"source",isValidConnection:w,doc:H,lib:c,flowId:f,nodeLookup:s});Y=p.handleDomNode,Z=p.connection,e=!!n,u=p.isValid,d=null,u?d=!0:e&&!u&&(d=!1),C=d;let g={...F,isValid:C,to:p.toHandle&&C?ta({x:p.toHandle.x,y:p.toHandle.y},y):_,toHandle:p.toHandle,toPosition:C&&p.toHandle?p.toHandle.position:N[O.position],toNode:p.toHandle?s.get(p.toHandle.nodeId):null};C&&n&&F.toHandle&&g.toHandle&&F.toHandle.type===g.toHandle.type&&F.toHandle.nodeId===g.toHandle.nodeId&&F.toHandle.id===g.toHandle.id&&F.to.x===g.to.x&&F.to.y===g.to.y||(b(g),F=g)}function q(t){if(S){(n||Y)&&Z&&C&&(null==x||x(Z));let{inProgress:e,...o}=F,i={...o,toPosition:F.toHandle?F.toPosition:null};null==m||m(t,i),u&&(null==M||M(t,i))}p(),cancelAnimationFrame(A),V=!1,C=!1,Z=null,Y=null,H.removeEventListener("mousemove",W),H.removeEventListener("mouseup",q),H.removeEventListener("touchmove",W),H.removeEventListener("touchend",q)}0===P&&X(),H.addEventListener("mousemove",W),H.addEventListener("mouseup",q),H.addEventListener("touchmove",W),H.addEventListener("touchend",q)},isValid:er};function ea(t){let{domNode:e,panZoom:n,getTransform:o,getViewScale:i}=t,l=(0,x.Z)(e);return{update:function(t){let{translateExtent:e,width:r,height:u,zoomStep:a=10,pannable:d=!0,zoomable:s=!0,inversePan:c=!1}=t,h=[0,0],f=(0,w.sP)().on("start",t=>{if("mousedown"===t.sourceEvent.type||"touchstart"===t.sourceEvent.type){var e,n;h=[null!==(e=t.sourceEvent.clientX)&&void 0!==e?e:t.sourceEvent.touches[0].clientX,null!==(n=t.sourceEvent.clientY)&&void 0!==n?n:t.sourceEvent.touches[0].clientY]}}).on("zoom",d?t=>{var l,a;let d=o();if("mousemove"!==t.sourceEvent.type&&"touchmove"!==t.sourceEvent.type||!n)return;let s=[null!==(l=t.sourceEvent.clientX)&&void 0!==l?l:t.sourceEvent.touches[0].clientX,null!==(a=t.sourceEvent.clientY)&&void 0!==a?a:t.sourceEvent.touches[0].clientY],f=[s[0]-h[0],s[1]-h[1]];h=s;let v=i()*Math.max(d[2],Math.log(d[2]))*(c?-1:1),y={x:d[0]-f[0]*v,y:d[1]-f[1]*v};n.setViewportConstrained({x:y.x,y:y.y,zoom:d[2]},[[0,0],[r,u]],e)}:null).on("zoom.wheel",s?t=>{let e=o();if("wheel"!==t.sourceEvent.type||!n)return;let i=-t.sourceEvent.deltaY*(1===t.sourceEvent.deltaMode?.05:t.sourceEvent.deltaMode?1:.002)*a,l=e[2]*Math.pow(2,i);n.scaleTo(l)}:null);l.call(f,{})},destroy:function(){l.on("zoom",null)},pointer:m.Z}}let ed=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,es=t=>({x:t.x,y:t.y,zoom:t.k}),ec=t=>{let{x:e,y:n,zoom:o}=t;return w.CR.translate(e,n).scale(o)},eh=(t,e)=>t.target.closest(".".concat(e)),ef=(t,e)=>2===e&&Array.isArray(t)&&t.includes(2),ev=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,ey=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ev,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},i="number"==typeof e&&e>0;return i||o(),i?t.transition().duration(e).ease(n).on("end",o):t},ep=t=>{let e=t.ctrlKey&&tc()?10:1;return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*e};function eg(t){let{domNode:e,minZoom:n,maxZoom:o,paneClickDistance:i,translateExtent:l,viewport:r,onPanZoom:u,onPanZoomStart:a,onPanZoomEnd:d,onDraggingChange:s}=t,h={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),v=(0,w.sP)().clickDistance(!ti(i)||i<0?0:i).scaleExtent([n,o]).translateExtent(l),y=(0,x.Z)(e).call(v);z({x:r.x,y:r.y,zoom:W(r.zoom,n,o)},[[0,0],[f.width,f.height]],l);let p=y.on("wheel.zoom"),g=y.on("dblclick.zoom");function E(t,e){return y?new Promise(n=>{null==v||v.interpolate((null==e?void 0:e.interpolate)==="linear"?M.Z:b.Z).transform(ey(y,null==e?void 0:e.duration,null==e?void 0:e.ease,()=>n(!0)),t)}):Promise.resolve(!1)}function I(){v.on("zoom",null)}async function z(t,e,n){let o=ec(t),i=null==v?void 0:v.constrain()(o,e,n);return i&&await E(i),new Promise(t=>t(i))}return v.wheelDelta(ep),{update:function(t){let{noWheelClassName:e,noPanClassName:n,onPaneContextMenu:o,userSelectionActive:i,panOnScroll:l,panOnDrag:r,panOnScrollMode:f,panOnScrollSpeed:x,preventScrolling:w,zoomOnPinch:M,zoomOnScroll:b,zoomOnDoubleClick:E,zoomActivationKeyPressed:z,lib:P,onTransformChange:H}=t;i&&!h.isZoomingOrPanning&&I();let N=!l||z||i?function(t){let{noWheelClassName:e,preventScrolling:n,d3ZoomHandler:o}=t;return function(t,i){let l="wheel"===t.type,r=!n&&l&&!t.ctrlKey,u=eh(t,e);if(t.ctrlKey&&l&&u&&t.preventDefault(),r||u)return null;t.preventDefault(),o.call(this,t,i)}}({noWheelClassName:e,preventScrolling:w,d3ZoomHandler:p}):function(t){let{zoomPanValues:e,noWheelClassName:n,d3Selection:o,d3Zoom:i,panOnScrollMode:l,panOnScrollSpeed:r,zoomOnPinch:u,onPanZoomStart:a,onPanZoom:d,onPanZoomEnd:s}=t;return t=>{if(eh(t,n))return!1;t.preventDefault(),t.stopImmediatePropagation();let h=o.property("__zoom").k||1;if(t.ctrlKey&&u){let e=(0,m.Z)(t),n=ep(t);i.scaleTo(o,h*Math.pow(2,n),e,t);return}let f=1===t.deltaMode?20:1,v=l===c.Vertical?0:t.deltaX*f,y=l===c.Horizontal?0:t.deltaY*f;!tc()&&t.shiftKey&&l!==c.Vertical&&(v=t.deltaY*f,y=0),i.translateBy(o,-(v/h)*r,-(y/h)*r,{internal:!0});let p=es(o.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,null==a||a(t,p)),e.isPanScrolling&&(null==d||d(t,p),e.panScrollTimeout=setTimeout(()=>{null==s||s(t,p),e.isPanScrolling=!1},150))}}({zoomPanValues:h,noWheelClassName:e,d3Selection:y,d3Zoom:v,panOnScrollMode:f,panOnScrollSpeed:x,zoomOnPinch:M,onPanZoomStart:a,onPanZoom:u,onPanZoomEnd:d});if(y.on("wheel.zoom",N,{passive:!1}),!i){let t=function(t){let{zoomPanValues:e,onDraggingChange:n,onPanZoomStart:o}=t;return t=>{var i,l,r;if(null===(i=t.sourceEvent)||void 0===i?void 0:i.internal)return;let u=es(t.transform);e.mouseButton=(null===(l=t.sourceEvent)||void 0===l?void 0:l.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=u,(null===(r=t.sourceEvent)||void 0===r?void 0:r.type)==="mousedown"&&n(!0),o&&(null==o||o(t.sourceEvent,u))}}({zoomPanValues:h,onDraggingChange:s,onPanZoomStart:a});v.on("start",t);let e=function(t){let{zoomPanValues:e,panOnDrag:n,onPaneContextMenu:o,onTransformChange:i,onPanZoom:l}=t;return t=>{var r,u,a;e.usedRightMouseButton=!!(o&&ef(n,null!==(a=e.mouseButton)&&void 0!==a?a:0)),(null===(r=t.sourceEvent)||void 0===r?void 0:r.sync)||i([t.transform.x,t.transform.y,t.transform.k]),!l||(null===(u=t.sourceEvent)||void 0===u?void 0:u.internal)||null==l||l(t.sourceEvent,es(t.transform))}}({zoomPanValues:h,panOnDrag:r,onPaneContextMenu:!!o,onPanZoom:u,onTransformChange:H});v.on("zoom",e);let n=function(t){let{zoomPanValues:e,panOnDrag:n,panOnScroll:o,onDraggingChange:i,onPanZoomEnd:l,onPaneContextMenu:r}=t;return t=>{var u,a;if((null===(u=t.sourceEvent)||void 0===u||!u.internal)&&(e.isZoomingOrPanning=!1,r&&ef(n,null!==(a=e.mouseButton)&&void 0!==a?a:0)&&!e.usedRightMouseButton&&t.sourceEvent&&r(t.sourceEvent),e.usedRightMouseButton=!1,i(!1),l&&ed(e.prevViewport,t.transform))){let n=es(t.transform);e.prevViewport=n,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{null==l||l(t.sourceEvent,n)},o?150:0)}}}({zoomPanValues:h,panOnDrag:r,panOnScroll:l,onPaneContextMenu:o,onPanZoomEnd:d,onDraggingChange:s});v.on("end",n)}let A=function(t){let{zoomActivationKeyPressed:e,zoomOnScroll:n,zoomOnPinch:o,panOnDrag:i,panOnScroll:l,zoomOnDoubleClick:r,userSelectionActive:u,noWheelClassName:a,noPanClassName:d,lib:s}=t;return t=>{var c;let h=e||n,f=o&&t.ctrlKey;if(1===t.button&&"mousedown"===t.type&&(eh(t,"".concat(s,"-flow__node"))||eh(t,"".concat(s,"-flow__edge"))))return!0;if(!i&&!h&&!l&&!r&&!o||u||eh(t,a)&&"wheel"===t.type||eh(t,d)&&("wheel"!==t.type||l&&"wheel"===t.type&&!e)||!o&&t.ctrlKey&&"wheel"===t.type)return!1;if(!o&&"touchstart"===t.type&&(null===(c=t.touches)||void 0===c?void 0:c.length)>1)return t.preventDefault(),!1;if(!h&&!l&&!f&&"wheel"===t.type||!i&&("mousedown"===t.type||"touchstart"===t.type)||Array.isArray(i)&&!i.includes(t.button)&&"mousedown"===t.type)return!1;let v=Array.isArray(i)&&i.includes(t.button)||!t.button||t.button<=1;return(!t.ctrlKey||"wheel"===t.type)&&v}}({zoomActivationKeyPressed:z,panOnDrag:r,zoomOnScroll:b,panOnScroll:l,zoomOnDoubleClick:E,zoomOnPinch:M,userSelectionActive:i,noPanClassName:n,noWheelClassName:e,lib:P});v.filter(A),E?y.on("dblclick.zoom",g):y.on("dblclick.zoom",null)},destroy:I,setViewport:async function(t,e){let n=ec(t);return await E(n,e),new Promise(t=>t(n))},setViewportConstrained:z,getViewport:function(){let t=y?(0,w.P2)(y.node()):{x:0,y:0,k:1};return{x:t.x,y:t.y,zoom:t.k}},scaleTo:function(t,e){return y?new Promise(n=>{null==v||v.interpolate((null==e?void 0:e.interpolate)==="linear"?M.Z:b.Z).scaleTo(ey(y,null==e?void 0:e.duration,null==e?void 0:e.ease,()=>n(!0)),t)}):Promise.resolve(!1)},scaleBy:function(t,e){return y?new Promise(n=>{null==v||v.interpolate((null==e?void 0:e.interpolate)==="linear"?M.Z:b.Z).scaleBy(ey(y,null==e?void 0:e.duration,null==e?void 0:e.ease,()=>n(!0)),t)}):Promise.resolve(!1)},setScaleExtent:function(t){null==v||v.scaleExtent(t)},setTranslateExtent:function(t){null==v||v.translateExtent(t)},syncViewport:function(t){if(y){let e=ec(t),n=y.property("__zoom");(n.k!==t.zoom||n.x!==t.x||n.y!==t.y)&&(null==v||v.transform(y,e,null,{sync:!0}))}},setClickDistance:function(t){let e=!ti(t)||t<0?0:t;null==v||v.clickDistance(e)}}}(d=p||(p={})).Line="line",d.Handle="handle";let ex=["top-left","top-right","bottom-left","bottom-right"],em=["top","right","bottom","left"];function ew(t,e){return Math.max(0,e-t)}function eM(t,e){return Math.max(0,t-e)}function eb(t,e,n){return Math.max(0,e-t,t-n)}let eE={width:0,height:0,x:0,y:0},eI={...eE,pointerX:0,pointerY:0,aspectRatio:1};function ez(t){let{domNode:e,nodeId:n,getStoreItems:o,onChange:i,onEnd:l}=t,r=(0,x.Z)(e);return{update:function(t){let e,u,a,d,{controlPosition:s,boundaries:c,keepAspectRatio:h,resizeDirection:f,onResizeStart:v,onResize:y,onResizeEnd:p,shouldResize:x}=t,m={...eE},w={...eI},M=function(t){let e=t.includes("right")||t.includes("left");return{isHorizontal:e,isVertical:t.includes("bottom")||t.includes("top"),affectsX:t.includes("left"),affectsY:t.includes("top")}}(s),b=null,E=[],I=(0,g.Z)().on("start",t=>{var i,l,r,s,c,h,f;let{nodeLookup:y,transform:p,snapGrid:g,snapToGrid:x,nodeOrigin:M,paneDomNode:I}=o();if(!(e=y.get(n)))return;b=null!==(i=null==I?void 0:I.getBoundingClientRect())&&void 0!==i?i:null;let{xSnapped:z,ySnapped:P}=tm(t.sourceEvent,{transform:p,snapGrid:g,snapToGrid:x,containerBounds:b});for(let[t,o]of(w={...m={width:null!==(l=e.measured.width)&&void 0!==l?l:0,height:null!==(r=e.measured.height)&&void 0!==r?r:0,x:null!==(s=e.position.x)&&void 0!==s?s:0,y:null!==(c=e.position.y)&&void 0!==c?c:0},pointerX:z,pointerY:P,aspectRatio:m.width/m.height},u=void 0,e.parentId&&("parent"===e.extent||e.expandParent)&&(a=(u=y.get(e.parentId))&&"parent"===e.extent?[[0,0],[(f=u).measured.width,f.measured.height]]:void 0),E=[],d=void 0,y))if(o.parentId===n&&(E.push({id:t,position:{...o.position},extent:o.extent}),"parent"===o.extent||o.expandParent)){let t=function(t,e,n){var o,i;let l=e.position.x+t.position.x,r=e.position.y+t.position.y,u=null!==(o=t.measured.width)&&void 0!==o?o:0,a=null!==(i=t.measured.height)&&void 0!==i?i:0,d=n[0]*u,s=n[1]*a;return[[l-d,r-s],[l+u-d,r+a-s]]}(o,e,null!==(h=o.origin)&&void 0!==h?h:M);d=d?[[Math.min(t[0][0],d[0][0]),Math.min(t[0][1],d[0][1])],[Math.max(t[1][0],d[1][0]),Math.max(t[1][1],d[1][1])]]:t}null==v||v(t,{...m})}).on("drag",t=>{var n,l,r;let{transform:s,snapGrid:v,snapToGrid:p,nodeOrigin:g}=o(),I=tm(t.sourceEvent,{transform:s,snapGrid:v,snapToGrid:p,containerBounds:b}),z=[];if(!e)return;let{x:P,y:H,width:N,height:A}=m,B={},k=null!==(n=e.origin)&&void 0!==n?n:g,{width:L,height:T,x:S,y:R}=function(t,e,n,o,i,l,r,u){let{affectsX:a,affectsY:d}=e,{isHorizontal:s,isVertical:c}=e,h=s&&c,{xSnapped:f,ySnapped:v}=n,{minWidth:y,maxWidth:p,minHeight:g,maxHeight:x}=o,{x:m,y:w,width:M,height:b,aspectRatio:E}=t,I=Math.floor(s?f-t.pointerX:0),z=Math.floor(c?v-t.pointerY:0),P=M+(a?-I:I),H=b+(d?-z:z),N=-l[0]*M,A=-l[1]*b,B=eb(P,y,p),k=eb(H,g,x);if(r){let t=0,e=0;a&&I<0?t=ew(m+I+N,r[0][0]):!a&&I>0&&(t=eM(m+P+N,r[1][0])),d&&z<0?e=ew(w+z+A,r[0][1]):!d&&z>0&&(e=eM(w+H+A,r[1][1])),B=Math.max(B,t),k=Math.max(k,e)}if(u){let t=0,e=0;a&&I>0?t=eM(m+I,u[0][0]):!a&&I<0&&(t=ew(m+P,u[1][0])),d&&z>0?e=eM(w+z,u[0][1]):!d&&z<0&&(e=ew(w+H,u[1][1])),B=Math.max(B,t),k=Math.max(k,e)}if(i&&(s&&(B=Math.max(B,eb(P/E,g,x)*E),r&&(B=Math.max(B,(a||d)&&(!a||d||!h)?ew(w+A+(a?I:-I)/E,r[0][1])*E:eM(w+A+P/E,r[1][1])*E)),u&&(B=Math.max(B,(a||d)&&(!a||d||!h)?eM(w+(a?I:-I)/E,u[0][1])*E:ew(w+P/E,u[1][1])*E))),c&&(k=Math.max(k,eb(H*E,y,p)/E),r&&(k=Math.max(k,(a||d)&&(!d||a||!h)?ew(m+(d?z:-z)*E+N,r[0][0])/E:eM(m+H*E+N,r[1][0])/E)),u&&(k=Math.max(k,(a||d)&&(!d||a||!h)?eM(m+(d?z:-z)*E,u[0][0])/E:ew(m+H*E,u[1][0])/E)))),z+=z<0?k:-k,I+=I<0?B:-B,i){if(h){var L,T,S,R;P>H*E?z=((L=a,T=d,L?!T:T)?-I:I)/E:I=((S=a,R=d,S?!R:R)?-z:z)*E}else s?(z=I/E,d=a):(I=z*E,a=d)}let _=a?m+I:m,V=d?w+z:w;return{width:M+(a?-I:I),height:b+(d?-z:z),x:l[0]*I*(a?-1:1)+_,y:l[1]*z*(d?-1:1)+V}}(w,M,I,c,h,k,a,d),_=L!==N,V=T!==A,Z=S!==P&&_,C=R!==H&&V;if(!Z&&!C&&!_&&!V)return;if((Z||C||1===k[0]||1===k[1])&&(B.x=Z?S:m.x,B.y=C?R:m.y,m.x=B.x,m.y=B.y,E.length>0)){let t=S-P,e=R-H;for(let n of E)n.position={x:n.position.x-t+k[0]*(L-N),y:n.position.y-e+k[1]*(T-A)},z.push(n)}if((_||V)&&(B.width=_&&(!f||"horizontal"===f)?L:m.width,B.height=V&&(!f||"vertical"===f)?T:m.height,m.width=B.width,m.height=B.height),u&&e.expandParent){let t=k[0]*(null!==(l=B.width)&&void 0!==l?l:0);B.x&&B.x<t&&(m.x=t,w.x=w.x-(B.x-t));let e=k[1]*(null!==(r=B.height)&&void 0!==r?r:0);B.y&&B.y<e&&(m.y=e,w.y=w.y-(B.y-e))}let Y=function(t){let{width:e,prevWidth:n,height:o,prevHeight:i,affectsX:l,affectsY:r}=t,u=e-n,a=o-i,d=[u>0?1:u<0?-1:0,a>0?1:a<0?-1:0];return u&&l&&(d[0]=-1*d[0]),a&&r&&(d[1]=-1*d[1]),d}({width:m.width,prevWidth:N,height:m.height,prevHeight:A,affectsX:M.affectsX,affectsY:M.affectsY}),O={...m,direction:Y};!1!==(null==x?void 0:x(t,O))&&(null==y||y(t,O),i(B,z))}).on("end",t=>{null==p||p(t,{...m}),null==l||l({...m})});r.call(I)},destroy:function(){r.on(".drag",null)}}}}}]);