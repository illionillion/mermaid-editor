(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{91646:function(e,n,t){Promise.resolve().then(t.bind(t,21549))},21549:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return R}});var o=t(14297),l=t(58071);t(58631);var a=t(23038),s=t(31087),r=t(84922),i=t(13812),c=t(63475),d=t(90813);let u={editableNode:function(e){let{data:n,id:t}=e,[s,u]=(0,i.useState)(!1),[h,x]=(0,i.useState)(n.label),p=()=>{u(!1),n.onLabelChange&&n.onLabelChange(t,h)};return(0,o.jsxs)(r.x,{bg:"white",border:"2px solid #1a365d",borderRadius:"md",p:2,w:"120px",minH:"40px",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",cursor:"pointer",onDoubleClick:()=>{u(!0)},_hover:{boxShadow:"md"},children:[(0,o.jsx)(l.HH,{type:"target",position:a.Ly.Top}),s?(0,o.jsx)(c.I,{value:h,onChange:e=>{x(e.target.value)},onBlur:p,onKeyDown:e=>{"Enter"===e.key&&p()},size:"sm",autoFocus:!0,textAlign:"center",border:"none",w:"100px",h:"24px",p:0,bg:"transparent",_focus:{boxShadow:"none",outline:"none"}}):(0,o.jsx)(d.x,{w:"100px",fontSize:"sm",fontWeight:"medium",wordBreak:"break-word",lineHeight:"1.2",children:h}),(0,o.jsx)(l.HH,{type:"source",position:a.Ly.Bottom})]})}};var h=t(91861),x=t(81710),p=t(11253),b=t(26026);function f(e){let{onAddNode:n,onGenerateCode:t}=e;return(0,o.jsx)(l.s_,{position:"top-left",children:(0,o.jsxs)(h.gC,{gap:4,p:4,bg:"white",borderRadius:"md",boxShadow:"md",children:[(0,o.jsx)(d.x,{fontSize:"lg",fontWeight:"bold",children:"Mermaid フローチャート エディター"}),(0,o.jsxs)(h.gC,{gap:2,align:"start",children:[(0,o.jsx)(d.x,{fontSize:"sm",color:"gray.600",children:"\uD83D\uDCA1 ヒント: ノードをダブルクリックで編集、ドラッグして空の場所で新ノード作成"}),(0,o.jsxs)(h.Ug,{gap:2,children:[(0,o.jsx)(x.z,{startIcon:(0,o.jsx)(p.p,{}),colorScheme:"blue",size:"sm",onClick:n,children:"ノード追加"}),(0,o.jsx)(x.z,{startIcon:(0,o.jsx)(b.d,{}),colorScheme:"green",size:"sm",onClick:t,children:"コード生成"})]})]})]})})}var g=t(97981),m=t(80677),j=t(31542),C=t(15213),w=t(81301),y=t(74006),S=t(29586),k=t(11677),v=t(91255),z=t(38614),_=t(23026),N=t(82278);let E=(0,i.memo)((0,v.forwardRef)((e,n)=>{let{value:t,...l}=e,{hasCopied:a,onCopy:s}=(0,z.useClipboard)(t);return(0,o.jsx)(_.u,{alignItems:"center",bg:"success",display:"inline-flex",h:"8",open:a,label:"Copied!",placement:"left",zIndex:"1000",children:(0,o.jsx)(N.h,{ref:n,size:"sm",variant:"unstyled","aria-label":"Copy the code",alignItems:"center",bg:["neutral.800","neutral.900"],border:"1px solid",borderColor:a?"success":"whiteAlpha.600",color:a?"success":"whiteAlpha.600",display:"flex",icon:a?(0,o.jsx)(S.n,{fontSize:"lg"}):(0,o.jsx)(k.T,{fontSize:"md"}),justifyContent:"center",_hover:{borderColor:a?"success":"whiteAlpha.800",color:a?"success":"whiteAlpha.800"},...l,onClick:s})})}));function I(e){let{open:n,onClose:t,mermaidCode:l}=e,a=(0,i.useCallback)(()=>{let e=document.createElement("a"),n=new Blob([l],{type:"text/plain"});e.href=URL.createObjectURL(n),e.download="flowchart.mmd",document.body.appendChild(e),e.click(),document.body.removeChild(e)},[l]);return(0,o.jsxs)(g.u,{open:n,onClose:t,size:"2xl",children:[(0,o.jsx)(m.x,{children:(0,o.jsxs)(h.Ug,{justify:"space-between",children:[(0,o.jsx)(d.x,{children:"生成されたMermaidコード"}),(0,o.jsx)(x.z,{startIcon:(0,o.jsx)(y._,{}),colorScheme:"blue",size:"sm",onClick:a,children:"ダウンロード"})]})}),(0,o.jsx)(j.o,{}),(0,o.jsxs)(C.f,{pb:6,position:"relative",children:[(0,o.jsx)(E,{value:l,position:"absolute",top:2,right:6,zIndex:1}),(0,o.jsx)(w.g,{value:l,readOnly:!0,rows:15,fontFamily:"mono",fontSize:"sm"})]})]})}let L=[{id:"1",type:"editableNode",position:{x:250,y:5},data:{label:"Start"}}],A=[];function D(){let[e,n,t]=(0,l.Rr)(L),[c,d,h]=(0,l.ll)(A),[x,p]=(0,i.useState)(2),{open:b,onOpen:g,onClose:m}=(0,s.useDisclosure)(),[j,C]=(0,i.useState)(""),w=(0,i.useRef)(null),{screenToFlowPosition:y}=(0,l._K)(),S=(0,i.useCallback)((e,t)=>{n(n=>n.map(n=>n.id===e?{...n,data:{...n.data,label:t}}:n))},[n]);(0,i.useEffect)(()=>{n(e=>e.map(e=>({...e,data:{...e.data,onLabelChange:S}})))},[S,n]);let k=(0,i.useCallback)(e=>d(n=>(0,a.Z_)(e,n)),[d]),v=(0,i.useCallback)((e,n)=>{w.current=n.nodeId},[]),z=(0,i.useCallback)(e=>{var t,o;if(w.current){if(null===(o=e.target)||void 0===o?void 0:null===(t=o.classList)||void 0===t?void 0:t.contains("react-flow__pane")){let t=y({x:e.clientX,y:e.clientY}),o={id:x.toString(),type:"editableNode",position:t,data:{label:"Node ".concat(x),onLabelChange:S}};n(e=>e.concat(o));let l={id:"".concat(w.current,"-").concat(x),source:w.current,target:x.toString()};d(e=>[...e,l]),p(x+1)}w.current=null}},[x,n,d,y,S]),_=(0,i.useCallback)(()=>{let e={id:x.toString(),type:"editableNode",position:{x:500*Math.random(),y:500*Math.random()},data:{label:"Node ".concat(x),onLabelChange:S}};n(n=>n.concat(e)),p(x+1)},[x,n,S]),N=(0,i.useCallback)(()=>{let n="flowchart TD\n";e.forEach(e=>{n+="    ".concat(e.id,"[").concat(e.data.label,"]\n")}),c.forEach(e=>{n+="    ".concat(e.source," --> ").concat(e.target,"\n")}),C(n),g()},[e,c,g]);return(0,o.jsxs)(r.x,{h:"100vh",w:"full",children:[(0,o.jsxs)(l.x$,{nodes:e,edges:c,onNodesChange:t,onEdgesChange:h,onConnect:k,onConnectStart:v,onConnectEnd:z,nodeTypes:u,fitView:!0,children:[(0,o.jsx)(l.ZX,{}),(0,o.jsx)(l.Aq,{}),(0,o.jsx)(f,{onAddNode:_,onGenerateCode:N})]}),(0,o.jsx)(I,{open:b,onClose:m,mermaidCode:j})]})}function R(){return(0,o.jsx)(l.tV,{children:(0,o.jsx)(D,{})})}}},function(e){e.O(0,[868,616,62,976,920,681,452,744],function(){return e(e.s=91646)}),_N_E=e.O()}]);