(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462,773,931],{50596:function(e,t,n){Promise.resolve().then(n.bind(n,20899))},79544:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var a=n(48983),r=n(61464),l=n(79950);let o=e=>{let{children:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Controls,{}),(0,a.jsx)(r.MiniMap,{}),(0,a.jsx)(r.Background,{}),t,(0,a.jsx)(l.K,{})]})}},79950:function(e,t,n){"use strict";n.d(t,{K:function(){return p}});var a=n(48983),r=n(61464),l=n(39971),o=n(20557),i=n(74881),s=n(44331),c=n(11375),d=n(21967),u=n(69452),h=n(27321),m=n(46061);let p=()=>(0,a.jsx)(r.Panel,{position:"top-right",children:(0,a.jsx)(x,{})}),x=()=>(0,a.jsxs)(s.v,{children:[(0,a.jsx)(c.j,{as:d.h,icon:(0,a.jsx)(l.E,{}),size:"sm","aria-label":"コントリビューションメニュー",bg:"gray.600",color:"white",_hover:{bg:"black",textDecoration:"none"}}),(0,a.jsxs)(u.q,{children:[(0,a.jsx)(h.sN,{as:m.r,href:"https://github.com/illionillion/mermaid-editor",target:"_blank",rel:"noopener noreferrer",icon:(0,a.jsx)(o.d,{}),children:"リポジトリを見る"}),(0,a.jsx)(h.sN,{as:m.r,href:"https://github.com/illionillion/mermaid-editor/issues/new/choose",target:"_blank",rel:"noopener noreferrer",icon:(0,a.jsx)(i.E,{}),children:"Issueを作成"})]})]})},52020:function(e,t,n){"use strict";n.d(t,{qi:function(){return d},D5:function(){return v},i9:function(){return j}}),n(79950);var a=n(48983),r=n(96172),l=n(80714),o=n(88614),i=n(78861),s=n(68614),c=n(21967);let d=(0,n(12685).memo)((0,o.forwardRef)((e,t)=>{let{value:n,...o}=e,{hasCopied:d,onCopy:u}=(0,i.useClipboard)(n);return(0,a.jsx)(s.u,{alignItems:"center",bg:"success",display:"inline-flex",h:"8",open:d,label:"Copied!",placement:"left",zIndex:"1000",children:(0,a.jsx)(c.h,{ref:t,size:"sm",variant:"unstyled","aria-label":"コードをコピーする",alignItems:"center",bg:["neutral.800","neutral.900"],border:"1px solid",borderColor:d?"success":"whiteAlpha.600",color:d?"success":"whiteAlpha.600",display:"flex",icon:d?(0,a.jsx)(r.n,{fontSize:"lg"}):(0,a.jsx)(l.T,{fontSize:"md"}),justifyContent:"center",_hover:{borderColor:d?"success":"whiteAlpha.800",color:d?"success":"whiteAlpha.800"},...o,onClick:u})})}));var u=n(44331),h=n(11375),m=n(49909),p=n(69452),x=n(27321),f=n(6474),g=n(37550);let b=[{label:"フローチャートエディタ",path:"/flow-chart"},{label:"ER図エディタ",path:"/er-diagram"}],j=()=>{var e,t;let n=null!==(e=(0,g.usePathname)())&&void 0!==e?e:"",r="/"===n,l=r?b.find(e=>"/flow-chart"===e.path):b.find(e=>n.startsWith(e.path)),o=b.filter(e=>!(r?"/flow-chart"===e.path:n.startsWith(e.path)));return(0,a.jsxs)(u.v,{children:[(0,a.jsx)(h.j,{as:m.z,variant:"outline",size:"sm",ml:{base:0,sm:"auto"},children:null!==(t=null==l?void 0:l.label)&&void 0!==t?t:"エディタを選択"}),(0,a.jsx)(p.q,{children:o.map(e=>(0,a.jsx)(x.sN,{as:f.default,href:""!==n?e.path:"#",children:e.label},e.path))})]})};var y=n(85709),C=n(57261),_=n(80010);let v=e=>{let{code:t,showLineNumbers:n=!0,minHeight:r="400px",fontSize:l="14px"}=e;return(0,a.jsx)(y.x,{w:"full",borderRadius:"md",overflow:"auto",border:"1px solid",borderColor:"border",children:(0,a.jsx)(C.Z,{language:"mermaid",style:_.Z,showLineNumbers:n,customStyle:{margin:0,fontSize:l,minHeight:r},children:t})})}},20899:function(e,t,n){"use strict";n.r(t),n.d(t,{ERDiagramEditor:function(){return ep}});var a=n(48983),r=n(61464),l=n(5301),o=n(78091),i=n(85709),s=n(12685),c=n(79544),d=n(80834),u=n(54117),h=n(67545),m=n(21967),p=n(28043),x=n(44331),f=n(11375),g=n(49909),b=n(10800),j=n(69452),y=n(27321);let C={"one-to-one":"||--||","one-to-many":"||--o{","many-to-one":"}o--||","many-to-many":"}o--o{","zero-to-one":"o|--||","one-to-zero":"||--o|","one-to-many-mandatory":"||--|{"},_={"one-to-one":"1...1","one-to-many":"1...*","many-to-one":"*...1","many-to-many":"*...*","zero-to-one":"0...1","one-to-zero":"1...0","one-to-many-mandatory":"1...+"},v=e=>{let{current:t,onChange:n}=e;return(0,a.jsxs)(x.v,{children:[(0,a.jsx)(f.j,{as:g.z,colorScheme:"green",size:"xs",rightIcon:(0,a.jsx)(p.v,{}),children:_[t]}),(0,a.jsx)(b.h,{children:(0,a.jsx)(j.q,{children:Object.entries(_).map(e=>{let[t,r]=e;return(0,a.jsxs)(y.sN,{onClick:()=>n(t),children:[r," ",t.replace(/-/g," ")]},t)})})})]})};function w(e){let{id:t,label:n,cardinality:r,onLabelChange:l,onCardinalityChange:o,onDelete:c}=e,[p,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(n),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{p&&b.current&&(b.current.focus(),b.current.select())},[p]);let j=()=>{x(!1),l(t,f)};return(0,a.jsx)(i.x,{children:p?(0,a.jsx)(u.I,{ref:b,value:f,onChange:e=>g(e.target.value),onBlur:j,onKeyDown:e=>{"Enter"===e.key&&j(),"Escape"===e.key&&(x(!1),g(n))},size:"sm",w:"120px",bg:"white",border:"1px solid",borderColor:"gray.300",fontSize:"12px",textAlign:"center"}):(0,a.jsxs)(h.Ug,{children:[(0,a.jsx)(i.x,{onClick:()=>x(!0),bg:"white",p:"1",px:"2",borderRadius:"md",fontSize:"xs",border:"1px solid",borderColor:"gray.300",cursor:"pointer",minW:"20px",textAlign:"center",children:f||"relation"}),(0,a.jsx)(v,{current:r,onChange:e=>o(t,e)}),(0,a.jsx)(m.h,{"aria-label":"Delete edge",icon:(0,a.jsx)(d.b,{}),size:"xs",variant:"outline",colorScheme:"red",onClick:()=>c(t)})]})})}var k=n(93876);/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function S(e,t){return e?"function"==typeof e&&(()=>{let t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()||"function"==typeof e||"object"==typeof e&&"symbol"==typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)?s.createElement(e,t):e:null}var E=n(88614),T=n(56595),z=n(33137),N=n(61325),R=n(91538),I=n(11676),D=n(88853),M=n(20064),A=n(53592),K=n(34455),L=n(66845),P=n(73490);let W=e=>{let{name:t,columns:n,onNameChange:r,onColumnsChange:l}=e,o=(e,t,a)=>{l(n.map((n,r)=>r===e?{...n,[t]:a}:n))},i=e=>{l(n.filter((t,n)=>n!==e))},c=function(e){let t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[n]=s.useState(()=>({current:(0,k.W_)(t)})),[a,r]=s.useState(()=>n.current.initialState);return n.current.setOptions(t=>({...t,...e,state:{...a,...e.state},onStateChange:t=>{r(t),null==e.onStateChange||e.onStateChange(t)}})),n.current}({data:n,columns:[{header:()=>"カラム名",cell:e=>{let{row:t,getValue:n}=e;return(0,a.jsx)(F,{value:n(),label:"カラム名",onCommit:e=>o(t.index,"name",e)})},accessorKey:"name"},{header:()=>"型",cell:e=>{let{row:t,getValue:n}=e;return(0,a.jsx)(F,{value:n(),label:"型",onCommit:e=>o(t.index,"type",e)})},accessorKey:"type"},{header:()=>"PK",cell:e=>{let{row:t}=e;return(0,a.jsx)(E.ui.input,{type:"checkbox",checked:n[t.index].pk,"aria-label":"PK",disabled:n[t.index].uk,onChange:e=>{let a=e.target.checked;l(n.map((e,n)=>n===t.index?{...e,pk:a}:e))}})},accessorKey:"pk"},{header:()=>"UK",cell:e=>{let{row:t}=e;return(0,a.jsx)(E.ui.input,{type:"checkbox",checked:n[t.index].uk,"aria-label":"UK",disabled:n[t.index].pk,onChange:e=>{let a=e.target.checked;l(n.map((e,n)=>n===t.index?{...e,uk:a}:e))}})},accessorKey:"uk"},{header:"",id:"actions",cell:e=>{let{row:t}=e;return(0,a.jsx)(m.h,{"aria-label":"削除",icon:(0,a.jsx)(d.b,{}),size:"xs",colorScheme:"danger",onClick:()=>i(t.index),variant:"outline"})}}],getCoreRowModel:(0,k.sC)()});return(0,a.jsx)(h.gC,{bg:"white",border:"2px solid #1a365d",borderRadius:"md",p:2,w:"full",minW:"xl",maxW:"5xl",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",cursor:"pointer",_hover:{boxShadow:"md"},position:"relative",children:(0,a.jsx)(T.x,{w:"full",children:(0,a.jsxs)(z.Q7,{variant:"simple",size:"sm",children:[(0,a.jsx)(N.R,{placement:"top",children:(0,a.jsxs)(h.Ug,{justifyContent:"space-between",w:"full",children:[(0,a.jsxs)(h.Ug,{as:R.__,children:[(0,a.jsx)(I.x,{fontWeight:"bold",fontSize:"md",children:"テーブル名"}),(0,a.jsx)(u.I,{"aria-label":"テーブル名",value:t,onChange:e=>r(e.target.value),fontWeight:"bold",fontSize:"md"})]}),(0,a.jsx)(g.z,{size:"md",colorScheme:"blue",onClick:()=>{l([...n,{name:"",type:"",pk:!1,uk:!1}])},children:"カラム追加"})]})}),(0,a.jsx)(D.h,{children:(0,a.jsx)(M.Tr,{children:c.getHeaderGroups()[0].headers.map(e=>(0,a.jsx)(A.Th,{fontWeight:"bold",textAlign:"left",children:S(e.column.columnDef.header,e.getContext())},e.id))})}),(0,a.jsx)(K.p,{children:c.getRowModel().rows.map(e=>(0,a.jsx)(M.Tr,{children:e.getVisibleCells().map(e=>(0,a.jsx)(L.Td,{children:(0,a.jsx)(P.M,{w:"full",h:"full",children:S(e.column.columnDef.cell,e.getContext())})},e.id))},e.id))})]})})})},F=e=>{let{value:t,onCommit:n,label:r}=e,[l,o]=(0,s.useState)(t),[i,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{o(t)},[t]),(0,a.jsx)(u.I,{"aria-label":r,size:"sm",value:l,onChange:e=>o(e.target.value),onCompositionStart:()=>c(!0),onCompositionEnd:e=>{c(!1),o(e.currentTarget.value)},onBlur:()=>n(l),onKeyDown:e=>{"Enter"!==e.key||i||(n(l),e.currentTarget.blur())}})};var U=n(21431),O=n(34045),B=n(50807),H=n(65666),V=n(52020),Z=n(75557),$=n(20333),q=n(24187),G=n(13839),X=n(86899),Q=n(67589),Y=n(55541);let J=Object.fromEntries(Object.entries(C).map(e=>{let[t,n]=e;return[n,t]})),ee=new RegExp("^([A-Za-z0-9_()]+)\\s+([A-Za-z0-9_]+)(?:\\s+".concat("(PK|UK)",")?$")),et=/^[\w-]+\s*\{/,en=new RegExp("^([\\w-]+)\\s+(".concat("\\|\\|--\\|\\||\\|\\|--o\\{|\\}o--\\|\\||\\}o--o\\{|o\\|--\\|\\||\\|\\|--o\\||\\|\\|--\\|\\{",")\\s+([\\w-]+)\\s*:(.*)$")),ea=/^[\s:"]+|[\s:"]+$/g,er={LEVEL_HEIGHT:280,TABLE_SPACING:450,CENTER_OFFSET:500,VERTICAL_OFFSET:100},el=e=>{let{open:t,onClose:n,onImport:r}=e,[l,o]=(0,s.useState)(""),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),m=async()=>{if(!l.trim()){c("Mermaidコードを入力してください");return}u(!0),c(null);try{let e=function(e){if(!e.trim().startsWith("erDiagram"))return{nodes:[],edges:[]};let t=e.split("\n").map(e=>e.trimEnd()),n=[],a=new Set,r=[],l=0,o=0;for(;o<t.length&&!/^erDiagram\b/.test(t[o]);)o++;for(o<t.length&&/^erDiagram\b/.test(t[o])&&o++;o<t.length;){let e=t[o].trim();if(!e){o++;continue}if(et.test(e)){let r=e.match(/^([\w-]+)\s*\{/);if(!r){o++;continue}let l=r[1],i=[];o++;let s=!1;for(;o<t.length;){let e=t[o].trim();if("}"===e){o++,s=!0;break}if(et.test(e))break;""!==e&&i.push(t[o]),o++}if(s){let e=i.map(e=>e.trim()).filter(e=>e&&!e.startsWith("//")).map(e=>{let t=e.match(ee);if(!t)return null;let[,n,a,r]=t;return{name:a,type:n,pk:"PK"===r,uk:"UK"===r}}).filter(Boolean);n.push({id:l,name:l,columns:e}),a.add(l)}continue}let i=e.match(en);if(i){let[,e,t,o,s]=i,c=J[t.trim()]||"one-to-many",d=s.replace(ea,"")||"relation";r.push({id:"edge-".concat(l++),type:"erEdge",source:e,target:o,data:{label:d,cardinality:c}}),a.has(e)||(n.push({id:e,name:e,columns:[]}),a.add(e)),a.has(o)||(n.push({id:o,name:o,columns:[]}),a.add(o))}o++}return{nodes:n,edges:r}}(l);if(0===e.nodes.length&&0===e.edges.length){c("有効なER図コードが見つかりませんでした。テーブルまたはリレーションの定義を確認してください。");return}r(e),o(""),n()}catch(e){c("Mermaidコードの解析中にエラーが発生しました")}finally{u(!1)}},p=()=>{o(""),c(null),n()};return(0,a.jsxs)(Z.u,{open:t,onClose:p,size:"2xl",children:[(0,a.jsx)($.Z,{}),(0,a.jsx)(q.x,{children:"Mermaid ER図コードインポート"}),(0,a.jsx)(G.f,{children:(0,a.jsxs)(h.gC,{gap:2,children:[(0,a.jsx)(I.x,{fontSize:"sm",color:"gray.600",children:"MermaidのER図コードを貼り付けてインポートできます"}),(0,a.jsx)(Y.W,{value:l,onChange:e=>{o(e),c(null)},placeholder:"例:\n".concat('erDiagram\n    User {\n      int id PK\n      varchar(255) name\n      varchar(255) email UK\n    }\n    Post {\n      int id PK\n      int user_id\n      varchar(255) title\n    }\n    User ||--o{ Post : "has posts"'),minHeight:"300px"}),i&&(0,a.jsx)(eo,{message:i}),(0,a.jsx)(I.x,{fontSize:"xs",color:"gray.500",children:"\uD83D\uDCA1 対応している機能: テーブル定義{columns}, リレーション(||--o{, }o--||, etc), 属性(PK, UK)"})]})}),(0,a.jsxs)(X.m,{children:[(0,a.jsx)(g.z,{onClick:p,children:"キャンセル"}),(0,a.jsx)(g.z,{colorScheme:"blue",onClick:m,loading:d,loadingText:"インポート中...",disabled:!l.trim(),children:"インポート"})]})]})},eo=e=>{let{message:t}=e;return(0,a.jsxs)(Q.bZ,{status:"error",children:[(0,a.jsx)(Q.zM,{}),(0,a.jsx)(Q.X,{children:t})]})};var ei=n(42617);let es=e=>{let{open:t,onClose:n,code:r,onDownload:l}=e;return(0,a.jsxs)(Z.u,{open:t,onClose:n,size:"2xl",children:[(0,a.jsx)(q.x,{children:(0,a.jsxs)(h.Ug,{justify:{base:"space-between",md:"flex-start"},display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",alignItems:"center",children:[(0,a.jsx)(I.x,{children:"生成されたMermaidコード"}),(0,a.jsx)(g.z,{startIcon:(0,a.jsx)(O._,{}),colorScheme:"blue",size:"sm",onClick:l,ml:{base:0,md:"auto"},children:"ダウンロード"})]})}),(0,a.jsx)(ei.o,{}),(0,a.jsxs)(G.f,{pb:6,position:"relative",children:[(0,a.jsx)(V.qi,{value:r,position:"absolute",top:2,right:6,zIndex:1}),(0,a.jsx)(V.D5,{code:r})]})]})},ec=e=>{let{onAddTable:t,onImportMermaid:n,nodes:l,edges:o,generateCode:i}=e,[s,c]=(0,H.useBoolean)(!1),[d,u]=(0,H.useBoolean)(!1),m=i(l,o);return(0,a.jsxs)(r.Panel,{position:"top-left",children:[(0,a.jsxs)(h.gC,{gap:4,p:4,bg:"white",borderRadius:"md",boxShadow:"md",children:[(0,a.jsxs)(h.Ug,{w:"full",display:{base:"flex",sm:"inline-flex"},flexWrap:"wrap",justify:"space-between",children:[(0,a.jsx)(I.x,{fontSize:"lg",fontWeight:"bold",children:"Mermaid ER図エディター"}),(0,a.jsx)(V.i9,{})]}),(0,a.jsxs)(h.gC,{gap:2,align:"start",children:[(0,a.jsx)(I.x,{fontSize:"sm",color:"gray.600",children:"\uD83D\uDCA1 ヒント: テーブルをダブルクリックで編集、ドラッグして空の場所で新テーブル作成"}),(0,a.jsxs)(h.Ug,{gap:2,display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",children:[(0,a.jsx)(g.z,{startIcon:(0,a.jsx)(U.p,{}),colorScheme:"blue",size:"sm",onClick:t,children:"テーブル追加"}),(0,a.jsx)(g.z,{startIcon:(0,a.jsx)(O._,{}),colorScheme:"green",size:"sm",onClick:c.on,children:"mermaidコード出力"}),(0,a.jsx)(g.z,{startIcon:(0,a.jsx)(B.r,{}),colorScheme:"purple",size:"sm",onClick:u.on,children:"mermaidインポート"})]})]})]}),(0,a.jsx)(es,{open:s,onClose:c.off,code:m,onDownload:()=>{let e=new Blob([m],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="er-diagram.mmd",n.click(),URL.revokeObjectURL(t)}}),(0,a.jsx)(el,{open:d,onClose:u.off,onImport:n})]})};function ed(e,t,n){return{id:e.toString(),type:"erTable",position:t,data:{name:"テーブル".concat(e),columns:[{name:"id",type:"int",pk:!0,uk:!1}],...n}}}function eu(e,t){return["erDiagram",...e.map(e=>["  ".concat(e.data.name," {"),...e.data.columns.map(e=>{let t=[e.type,e.name];return e.pk?t.push("PK"):e.uk&&t.push("UK"),"    ".concat(t.join(" "))}),"  }"].join("\n")),...t.filter(e=>"erEdge"===e.type).map(t=>{var n,a;let r=e.find(e=>e.id===t.source),l=e.find(e=>e.id===t.target);if(!r||!l)return"";let o=(null===(n=t.data)||void 0===n?void 0:n.label)||"relation",i=C[(null===(a=t.data)||void 0===a?void 0:a.cardinality)||"one-to-many"]||"||--o{";return"  ".concat(r.data.name," ").concat(i," ").concat(l.data.name," : ").concat(o)}).filter(Boolean)].join("\n")}let eh={erTable:function(e){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W,{...e.data}),(0,a.jsx)(r.Handle,{type:"target",position:l.Ly.Top}),(0,a.jsx)(r.Handle,{type:"source",position:l.Ly.Bottom})]})}},em={erEdge:function(e){let{id:t,sourceX:n,sourceY:o,targetX:s,targetY:c,sourcePosition:d,targetPosition:u,data:h,markerEnd:m}=e,[p,x,f]=(0,l.OQ)({sourceX:n,sourceY:o,sourcePosition:d,targetX:s,targetY:c,targetPosition:u});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.BaseEdge,{path:p,markerEnd:m}),(0,a.jsx)(r.EdgeLabelRenderer,{children:(0,a.jsx)(i.x,{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(x,"px,").concat(f,"px)"),pointerEvents:"all",className:"nodrag nopan",children:(0,a.jsx)(w,{id:t,label:(null==h?void 0:h.label)||"relation",cardinality:(null==h?void 0:h.cardinality)||"one-to-many",onLabelChange:(null==h?void 0:h.onLabelChange)||(()=>{}),onCardinalityChange:(null==h?void 0:h.onCardinalityChange)||(()=>{}),onDelete:(null==h?void 0:h.onDelete)||(()=>{})})})})]})}},ep=()=>{var e;let t=(0,s.useRef)(null),{screenToFlowPosition:n}=(0,r.useReactFlow)(),d=null!==(e=(0,o.useToken)("sizes","5xl"))&&void 0!==e?e:"320",u=d.endsWith("rem")?16*parseFloat(d):parseInt(d,10),[h,m,p]=(0,r.useNodesState)([{id:"1",type:"erTable",position:{x:100,y:100},data:{name:"ユーザー",columns:[{name:"id",type:"int",pk:!0,uk:!1},{name:"name",type:"varchar(255)",pk:!1,uk:!0}],onNameChange:()=>{},onColumnsChange:()=>{}}}]),[x,f,g]=(0,r.useEdgesState)([]),[b,j]=(0,s.useState)(2),y=(0,s.useCallback)((e,t)=>{f(n=>n.map(n=>n.id===e?{...n,data:{...n.data,label:t}}:n))},[f]),C=(0,s.useCallback)(e=>{f(t=>t.filter(t=>t.id!==e))},[f]),_=(0,s.useCallback)((e,t)=>{f(n=>n.map(n=>n.id===e?{...n,data:{...n.data,cardinality:t}}:n))},[f]),v=(0,s.useCallback)(()=>{let e=ed(b,{x:100+40*b,y:100+40*b},{onNameChange:e=>{m(t=>t.map(t=>t.id===b.toString()?{...t,data:{...t.data,name:e}}:t))},onColumnsChange:e=>{m(t=>t.map(t=>t.id===b.toString()?{...t,data:{...t.data,columns:e}}:t))}});m(t=>[...t,e]),j(e=>e+1)},[b,m]),w=(0,s.useCallback)(e=>{let t=function(e,t,n){let a=function(e){let t=new Map;return e.forEach((e,n)=>{let a=-(e.length*er.TABLE_SPACING)/2;e.forEach((e,r)=>{t.set(e,{x:a+r*er.TABLE_SPACING+er.CENTER_OFFSET,y:n*er.LEVEL_HEIGHT+er.VERTICAL_OFFSET})})}),t}(function(e){let t=new Map;return e.forEach((e,n)=>{t.has(e)||t.set(e,[]),t.get(e).push(n)}),t}(function(e,t){let n=new Map;e.forEach(e=>{n.set(e.id,0)});let a=new Set;t.forEach(e=>{a.add(e.target)});let r=e.filter(e=>!a.has(e.id));0===r.length&&e.length>0&&n.set(e[0].id,0);let l=r.map(e=>e.id),o=new Set;for(;l.length>0;){let e=l.shift();if(o.has(e))continue;o.add(e);let a=n.get(e)||0;t.forEach(t=>{if(t.source===e&&!o.has(t.target)){let e=a+1,r=n.get(t.target)||0;n.set(t.target,Math.max(r,e)),l.push(t.target)}})}return n}(e,t)));return e.map(e=>({id:e.id,type:"erTable",position:a.get(e.id)||{x:400,y:80},data:{name:e.name,columns:e.columns,onNameChange:t=>n.onNameChange(e.id,t),onColumnsChange:t=>n.onColumnsChange(e.id,t)}}))}(e.nodes,e.edges,{onNameChange:(e,t)=>{m(n=>n.map(n=>n.id===e?{...n,data:{...n.data,name:t}}:n))},onColumnsChange:(e,t)=>{m(n=>n.map(n=>n.id===e?{...n,data:{...n.data,columns:t}}:n))}});m(t),f(e.edges),j(Math.max(...t.map(e=>parseInt(e.id,10)||0))+1)},[m,f]),k=(0,s.useCallback)((e,n)=>{t.current="".concat(n.nodeId,"-").concat(n.handleType)},[]),S=(0,s.useCallback)(e=>{let a,r;if(!t.current)return;if("connected"===t.current){t.current=null;return}let l=e&&e.target||null;if(!(l&&l.closest&&l.closest(".react-flow__pane"))){t.current=null;return}let{sourceNodeId:o,handleType:i}=function(e){let[t,n]=e.split("-");return{sourceNodeId:t,handleType:n}}(t.current),s=h.find(e=>e.id===o),c=s&&Array.isArray(s.data.columns)?s.data.columns.length:1;e instanceof TouchEvent&&e.changedTouches.length>0?(a=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY):(a=e.clientX,r=e.clientY);let d=n({x:a,y:r}),p={x:d.x-u/2+90,y:d.y-(32*c+48)/2},x=ed(b,{x:p.x,y:p.y},{onNameChange:e=>{m(t=>t.map(t=>t.id===b.toString()?{...t,data:{...t.data,name:e}}:t))},onColumnsChange:e=>{m(t=>t.map(t=>t.id===b.toString()?{...t,data:{...t.data,columns:e}}:t))}});m(e=>[...e,x]);let g=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"relation",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"one-to-many";return{id:"".concat(e,"-").concat(t),source:"source"===n?e:t,target:"source"===n?t:e,type:"erEdge",data:{label:a,cardinality:r}}}(o,b.toString(),i);f(e=>[...e,g]),j(e=>e+1),t.current=null},[b,m,f,n,h,u]),E=(0,s.useCallback)(e=>{f(t=>(0,l.Z_)({...e,type:"erEdge",data:{label:"relation",cardinality:"one-to-many"}},t)),t.current="connected"},[f]),T=h.map(e=>"erTable"!==e.type?e:{...e,data:{...e.data,onNameChange:t=>{m(n=>n.map(n=>n.id===e.id?{...n,data:{...n.data,name:t}}:n))},onColumnsChange:t=>{m(n=>n.map(n=>n.id===e.id?{...n,data:{...n.data,columns:t}}:n))}}}),z=x.map(e=>"erEdge"!==e.type?e:{...e,data:{...e.data,onDelete:C,onCardinalityChange:_,onLabelChange:y}});return(0,a.jsx)(i.x,{h:"100vh",w:"full",children:(0,a.jsx)(r.ReactFlow,{nodes:T,edges:z,onNodesChange:p,onEdgesChange:g,onConnect:E,onConnectStart:k,onConnectEnd:S,nodeTypes:eh,edgeTypes:em,fitView:!0,children:(0,a.jsx)(c.f,{children:(0,a.jsx)(ec,{onAddTable:v,onImportMermaid:w,nodes:h,edges:x,generateCode:eu})})})})}},55541:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var a=n(48983),r=n(85709),l=n(78485),o=n(47104);n(6372),n(50590);let i=e=>{let{value:t,onChange:n,placeholder:i="Mermaidコードを入力...",minHeight:s="300px",fontSize:c="14px"}=e;return(0,a.jsx)(r.x,{w:"full",borderRadius:"md",overflow:"hidden",border:"1px solid",borderColor:"border",bg:"gray.900",color:"white",fontFamily:"mono",sx:{"& textarea::placeholder":{color:"white",opacity:.7}},children:(0,a.jsx)(o.Z,{value:t,onValueChange:n,highlight:e=>{try{return(0,l.highlight)(e,l.languages.mermaid,"mermaid")}catch(t){return e.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"})[e])}},padding:16,placeholder:i,style:{fontFamily:'"Fira code", "Fira Mono", Consolas, Monaco, "Courier New", monospace',fontSize:c,minHeight:s,lineHeight:"1.5",backgroundColor:"transparent",outline:"none",caretColor:"white"}})})}},73490:function(e,t,n){"use strict";n.d(t,{M:function(){return a}});var a=(0,n(88614).ui)("div",{baseStyle:{alignItems:"center",display:"flex",justifyContent:"center"}});a.displayName="Center",a.__ui__="Center"},56595:function(e,t,n){"use strict";n.d(t,{x:function(){return o}});var a=n(88614),r=n(11763),l=n(48983),o=(0,a.forwardRef)((e,t)=>{var n;let{className:o,overflow:i,overflowX:s,...c}=e,d={display:"block",maxW:"100%",overflowX:null!=(n=null!=i?i:s)?n:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch",whiteSpace:"nowrap"};return(0,l.jsx)(a.ui.div,{ref:t,className:(0,r.cx)("ui-table__container",o),__css:d,...c})});o.displayName="TableContainer",o.__ui__="TableContainer"},53592:function(e,t,n){"use strict";n.d(t,{Th:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,isNumeric:i,numeric:s=i,__css:c,...d}=e,u={...(0,a.p8)().th,...c};return(0,o.jsx)(r.ui.th,{ref:t,className:(0,l.cx)("ui-table__th",n),"data-is-numeric":s,__css:u,...d})});i.displayName="Th",i.__ui__="Th"},66845:function(e,t,n){"use strict";n.d(t,{Td:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,isNumeric:i,numeric:s=i,...c}=e,d={...(0,a.p8)().td};return(0,o.jsx)(r.ui.td,{ref:t,className:(0,l.cx)("ui-table__td",n),"data-is-numeric":s,__css:d,...c})});i.displayName="Td",i.__ui__="Td"},34455:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,...i}=e,s={...(0,a.p8)().tbody};return(0,o.jsx)(r.ui.tbody,{ref:t,className:(0,l.cx)("ui-table__tbody",n),__css:s,...i})});i.displayName="Tbody",i.__ui__="Tbody"},33137:function(e,t,n){"use strict";n.d(t,{Q7:function(){return s},ag:function(){return o},p8:function(){return i}});var a=n(88614),r=n(11763),l=n(48983),[o,i]=(0,r.kr)({name:"TableStyleContext",errorMessage:'useTableStyles returned is \'undefined\'. Seems you forgot to wrap the components in "<Table />" or "<NativeTable />" or "<PagingTable />"'}),s=(0,a.forwardRef)((e,t)=>{let[n,i]=(0,a.useComponentMultiStyle)("NativeTable",e),{className:s,layout:c,...d}=(0,a.omitThemeProps)(i,["withBorder","withColumnBorders","highlightOnHover"]),u={tableLayout:c,...n.table};return(0,l.jsx)(o,{value:n,children:(0,l.jsx)(a.ui.table,{ref:t,className:(0,r.cx)("ui-table",s),__css:u,...d})})});s.displayName="NativeTable",s.__ui__="NativeTable"},20064:function(e,t,n){"use strict";n.d(t,{Tr:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,...i}=e,s={...(0,a.p8)().tr};return(0,o.jsx)(r.ui.tr,{ref:t,className:(0,l.cx)("ui-table__tr",n),__css:s,...i})});i.displayName="Tr",i.__ui__="Tr"},88853:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,...i}=e,s={...(0,a.p8)().thead};return(0,o.jsx)(r.ui.thead,{ref:t,className:(0,l.cx)("ui-table__thead",n),__css:s,...i})});i.displayName="Thead",i.__ui__="Thead"},61325:function(e,t,n){"use strict";n.d(t,{R:function(){return i}});var a=n(33137),r=n(88614),l=n(11763),o=n(48983),i=(0,r.forwardRef)((e,t)=>{let{className:n,placement:i="bottom",...s}=e,c={captionSide:i,...(0,a.p8)().caption};return(0,o.jsx)(r.ui.caption,{ref:t,className:(0,l.cx)("ui-table__caption",n),__css:c,...s})});i.displayName="TableCaption",i.__ui__="TableCaption"}},function(e){e.O(0,[868,62,616,832,843,663,865,26,362,421,744],function(){return e(e.s=50596)}),_N_E=e.O()}]);