(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{92526:function(e,t,n){Promise.resolve().then(n.bind(n,22536)),Promise.resolve().then(n.bind(n,57469)),Promise.resolve().then(n.bind(n,35621)),Promise.resolve().then(n.bind(n,12678)),Promise.resolve().then(n.bind(n,28344)),Promise.resolve().then(n.bind(n,1261)),Promise.resolve().then(n.bind(n,4056))},22536:function(e,t,n){"use strict";n.r(t),n.d(t,{ArrowTypeSelector:function(){return p}});var r=n(14297),o=n(16152),a=n(17359),l=n(99592),i=n(82278),s=n(59143),c=n(30178),d=n(65807),u=n(38503),h=n(71334);function p(e){let{currentArrowType:t,onArrowTypeChange:n}=e;return(0,r.jsxs)(a.v,{children:[(0,r.jsx)(l.j,{className:"arrow-type-selector-button",as:i.h,"aria-label":"Select arrow type",icon:(0,r.jsx)(o.v,{}),size:"xs",variant:"outline",bg:"white",border:"1px solid",borderColor:"gray.300",_hover:{bg:"gray.50"}}),(0,r.jsx)(s.h,{children:(0,r.jsx)(c.q,{bg:"white",boxShadow:"lg",border:"1px solid",borderColor:"gray.200",children:h.ab.map(e=>(0,r.jsx)(d.sN,{onClick:()=>n(e),bg:t===e?"blue.50":"white",color:t===e?"blue.600":"gray.700",fontSize:"sm",children:(0,u.RG)(e)},e))})})]})}},57469:function(e,t,n){"use strict";n.r(t),n.d(t,{EdgeContent:function(){return f},EditableEdge:function(){return b}});var r=n(14297),o=n(58071),a=n(23038),l=n(59244),i=n(84922),s=n(63475),c=n(91861),d=n(82278),u=n(13812);function h(e){let t=new Map,n=new Map;return e.forEach(e=>{var t;n.has(e.source)||n.set(e.source,new Set),null===(t=n.get(e.source))||void 0===t||t.add(e.target)}),e.forEach(e=>{var r,o;let{source:a,target:l}=e;if(null===(r=n.get(l))||void 0===r?void 0:r.has(a)){let n=a<l?"".concat(a,"-").concat(l):"".concat(l,"-").concat(a);t.has(n)||t.set(n,[]),null===(o=t.get(n))||void 0===o||o.push(e)}}),t}let p=(e,t,n,r,o)=>{let a=r.find(t=>t.source===e.source&&t.target===e.target);if(!a)return{adjustedX:t,adjustedY:n};let{offsetX:l,offsetY:i}=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;for(let[,r]of Array.from(h(t).entries())){let t=r.find(t=>t.id===e.id);if(t){let e=r.indexOf(t),o=e%2==0?1:-1,a=Math.floor(e/2+1)*n*o;if(t.target===t.source)return function(e,t,n){let r=t.filter(t=>t.source===e.source&&t.target===e.target),o=r.findIndex(t=>t.id===e.id),a=2*Math.PI/Math.max(r.length,1)*o,l=n*(1+o);return{offsetX:Math.cos(a)*l,offsetY:Math.sin(a)*l}}(t,r,n);return{offsetX:String(t.target).localeCompare(String(t.source),void 0,{numeric:!0})>0?a:-a,offsetY:a}}}return{offsetX:0,offsetY:0}}(a,r);return{adjustedX:t+l,adjustedY:n+i}};var g=n(38503),x=n(22536);function f(e){let{id:t,labelX:n,labelY:o,data:a}=e,[h,p]=(0,u.useState)(!1),[f,b]=(0,u.useState)((null==a?void 0:a.label)||""),[m,y]=(0,u.useState)(!1),C=(0,u.useRef)(null);(0,u.useEffect)(()=>{h&&C.current&&(C.current.focus(),C.current.select())},[h]);let w=()=>{p(!1),(null==a?void 0:a.onLabelChange)&&a.onLabelChange(t,f)};return(0,r.jsx)(i.x,{position:"absolute",transform:"translate(-50%, -50%) translate(".concat(n,"px,").concat(o,"px)"),pointerEvents:"all",className:"nodrag nopan",children:h?(0,r.jsx)(s.I,{ref:C,value:f,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||m?"Escape"===e.key&&(p(!1),b((null==a?void 0:a.label)||"")):w()},onBlur:()=>{w()},onCompositionStart:()=>{y(!0)},onCompositionEnd:()=>{y(!1)},size:"sm",w:"120px",bg:"white",border:"1px solid",borderColor:"gray.300",fontSize:"12px",textAlign:"center"}):(0,r.jsxs)(c.Ug,{gap:"1",align:"center",children:[(0,r.jsxs)(i.x,{onClick:e=>{e.preventDefault(),e.stopPropagation(),p(!0)},bg:"white",p:"1",px:"2",borderRadius:"md",fontSize:"xs",border:"1px solid",borderColor:"gray.300",cursor:"pointer",minW:"20px",textAlign:"center",display:"flex",alignItems:"center",gap:"1",children:[(0,r.jsx)(i.x,{as:"span",color:"blue.600",fontWeight:"bold",children:(0,g.wL)((null==a?void 0:a.arrowType)||"arrow")}),(0,r.jsx)(i.x,{as:"span",children:f||"..."})]}),(0,r.jsx)(x.ArrowTypeSelector,{currentArrowType:(null==a?void 0:a.arrowType)||"arrow",onArrowTypeChange:e=>{(null==a?void 0:a.onArrowTypeChange)&&a.onArrowTypeChange(t,e)}}),(0,r.jsx)(d.h,{"aria-label":"Delete edge",icon:(0,r.jsx)(l.b,{}),size:"xs",variant:"ghost",colorScheme:"red",onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==a?void 0:a.onDelete)&&a.onDelete(t)},bg:"white",border:"1px solid",borderColor:"red.300",_hover:{bg:"red.50"}})]})})}function b(e){var t;let{id:n,sourceX:l,sourceY:i,targetX:s,targetY:c,sourcePosition:d,targetPosition:u,data:g,markerEnd:x,source:b,target:m}=e,{getEdges:y,getNodes:C}=(0,o._K)(),w=y(),j=C(),v={id:n,source:b,target:m},[E,S,T]=(0,a.OQ)({sourceX:l,sourceY:i,sourcePosition:d,targetX:s,targetY:c,targetPosition:u}),{adjustedX:k,adjustedY:F}=p(v,S,T,w,j),A=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let[,r]of Array.from(h(t).entries()))if(r.some(t=>t.source===e.source&&t.target===e.target)&&n)return{stroke:"#ff6b6b",strokeOpacity:.8,strokeWidth:2};return{}}(v,w,null!==(t=null==g?void 0:g.enableCyclicEdgeStyling)&&void 0!==t&&t);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.u5,{path:E,markerEnd:x,style:A}),(0,r.jsx)(o.XQ,{children:(0,r.jsx)(f,{id:n,labelX:k,labelY:F,data:g})})]})}},35621:function(e,t,n){"use strict";n.r(t),n.d(t,{FlowEditor:function(){return E}});var r=n(14297),o=n(58071),a=n(23038),l=n(31087),i=n(26451),s=n(84922),c=n(13812),d=n(82247),u=n(79780),h=n(82278),p=n(8785);let g=()=>(0,r.jsx)(o.s_,{position:"bottom-right",children:(0,r.jsx)(x,{})}),x=()=>(0,r.jsx)(h.h,{icon:(0,r.jsx)(u.E,{}),size:"sm",as:p.r,href:"https://github.com/illionillion/mermaid-editor",target:"_blank",rel:"noopener noreferrer",display:"flex",alignItems:"center",gap:1,fontSize:"sm",bg:"gray.600",color:"white",_hover:{bg:"black",textDecoration:"none"}}),f={editableEdge:n(57469).EditableEdge};function b(e,t,n){return{id:e.toString(),type:"editableNode",position:t,data:{label:"Node ".concat(e),variableName:"node".concat(e),shapeType:"rectangle",...n}}}var m=n(12678),y=n(28344);n(1261),n(4056);let C={editableNode:y.EditableNode},w={LEVEL_HEIGHT:150,NODE_SPACING:250,CENTER_OFFSET:300,VERTICAL_OFFSET:50},j=[{id:"1",type:"editableNode",position:{x:250,y:5},data:{label:"Start",variableName:"startNode",shapeType:"rectangle"}}],v=[];function E(){let[e,t,n]=(0,o.Rr)(j),[u,h,p]=(0,o.ll)(v),[x,y]=(0,c.useState)(2),{open:E,onOpen:S,onClose:T}=(0,l.useDisclosure)(),k=(0,c.useRef)(null),{screenToFlowPosition:F}=(0,o._K)(),A=(0,i.useToken)("sizes","xs"),N=(0,i.useToken)("sizes","6xs"),z=(e,t)=>{if(!e)return t;let n=parseFloat(e.replace("px","").replace("rem",""));return isNaN(n)?t:e.includes("rem")?16*n:n},_=z(A,80),D=z(N,48),L=(0,c.useCallback)((e,n)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,label:n}}:t))},[t]),I=(0,c.useCallback)((e,n)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,variableName:n}}:t))},[t]),R=(0,c.useCallback)((e,n)=>{t(t=>t.map(t=>t.id===e?{...t,data:{...t.data,shapeType:n}}:t))},[t]),M=(0,c.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e)),h(t=>t.filter(t=>t.source!==e&&t.target!==e))},[t,h]),O=(0,c.useCallback)((e,t)=>{h(n=>n.map(n=>n.id===e?{...n,data:{...n.data,label:t}}:n))},[h]),P=(0,c.useCallback)(e=>{h(t=>t.filter(t=>t.id!==e))},[h]),$=(0,c.useCallback)((e,t)=>{h(n=>n.map(n=>n.id===e?{...n,data:{...n.data,arrowType:t}}:n))},[h]);(0,c.useEffect)(()=>{t(e=>e.map(e=>({...e,data:{...e.data,onLabelChange:L,onVariableNameChange:I,onShapeTypeChange:R,onDelete:M}})))},[L,I,R,M,t]),(0,c.useEffect)(()=>{h(e=>e.map(e=>({...e,type:"editableEdge",data:{...e.data,onLabelChange:O,onArrowTypeChange:$,onDelete:P}})))},[O,$,P,h]);let Z=(0,c.useCallback)(e=>{let t={...e,type:"editableEdge",data:{label:"",arrowType:"arrow",onLabelChange:O,onArrowTypeChange:$,onDelete:P}};h(e=>(0,a.Z_)(t,e)),k.current="connected"},[h,O,$,P]),H=(0,c.useCallback)((e,t)=>{k.current=t.nodeId,k.current="".concat(t.nodeId,"-").concat(t.handleType)},[]),B=(0,c.useCallback)(n=>{var r,o,a,l;if(k.current){if("connected"===k.current){k.current=null;return}if(((null==n?void 0:null===(o=n.target)||void 0===o?void 0:null===(r=o.classList)||void 0===r?void 0:r.contains("react-flow__pane"))||n&&n.target instanceof Element&&n.target.closest(".react-flow__pane"))&&n){let r,o;let{sourceNodeId:i,handleType:s}=function(e){let[t,n]=e.split("-");return{sourceNodeId:t,handleType:n}}(k.current);if(!e.find(e=>e.id===i))return;n instanceof TouchEvent&&n.changedTouches.length>0?(r=n.changedTouches[0].clientX,o=n.changedTouches[0].clientY):(r=n.clientX,o=n.clientY);let c=b(x,{x:(a=F({x:r,y:o})).x-_/2,y:a.y-D/2},{onLabelChange:L,onVariableNameChange:I,onShapeTypeChange:R,onDelete:M});t(e=>e.concat(c));let d=(l=x.toString(),{id:"".concat(i,"-").concat(l),type:"editableEdge",source:"source"===s?i:l,target:"source"===s?l:i,data:{label:"",arrowType:"arrow",onLabelChange:O,onArrowTypeChange:$,onDelete:P}});h(e=>[...e,d]),y(x+1)}k.current=null}},[x,t,h,F,L,I,R,M,O,$,P,e,_,D]),V=(0,c.useCallback)(()=>{let e=b(x,{x:500*Math.random(),y:500*Math.random()},{onLabelChange:L,onVariableNameChange:I,onShapeTypeChange:R,onDelete:M});t(t=>t.concat(e)),y(x+1)},[x,t,L,I,R,M]),Y=(0,c.useCallback)(()=>{S()},[S]),X=(0,c.useCallback)(e=>{let n=((e,t)=>{let n=new Set(t.map(e=>e.target)),r=e.filter(e=>!n.has(e.id)),o=new Map,a=new Set,l=function(e){var n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(a.has(e))return;a.add(e);let i=null!==(n=o.get(e))&&void 0!==n?n:0;o.set(e,Math.max(i,r)),t.filter(t=>t.source===e).forEach(e=>{l(e.target,r+1)})};r.forEach(e=>l(e.id,0)),e.forEach(e=>{o.has(e.id)||o.set(e.id,0)});let i=new Map;o.forEach((e,t)=>{i.has(e)||i.set(e,[]),i.get(e).push(t)});let s=new Map;return i.forEach((e,t)=>{let n=-(e.length*w.NODE_SPACING)/2;e.forEach((e,r)=>{s.set(e,{x:n+r*w.NODE_SPACING+w.CENTER_OFFSET,y:t*w.LEVEL_HEIGHT+w.VERTICAL_OFFSET})})}),s})(e.nodes,e.edges),r=e.nodes.map(e=>({id:e.id,type:"editableNode",position:n.get(e.id)||{x:250,y:50},data:{label:e.label,variableName:e.variableName,shapeType:e.shapeType,onLabelChange:L,onVariableNameChange:I,onShapeTypeChange:R,onDelete:M}})),o=e.edges.map(e=>({id:e.id,source:e.source,target:e.target,type:"editableEdge",data:{label:e.label,arrowType:e.arrowType,onLabelChange:O,onArrowTypeChange:$,onDelete:P}}));t(r),h(o),y(e.nodes.length+1)},[t,h,L,I,R,M,O,$,P]);return(0,r.jsxs)(s.x,{h:"100vh",w:"full",children:[(0,r.jsxs)(o.x$,{nodes:e,edges:u,onNodesChange:n,onEdgesChange:p,onConnect:Z,onConnectStart:H,onConnectEnd:B,nodeTypes:C,edgeTypes:f,fitView:!0,children:[(0,r.jsx)(o.ZX,{}),(0,r.jsx)(o.Aq,{}),(0,r.jsx)(m.FlowPanel,{onAddNode:V,onGenerateCode:Y,onImportMermaid:X}),(0,r.jsx)(g,{})]}),(0,r.jsx)(d._v,{open:E,onClose:T,flowData:{nodes:e,edges:u}})]})}},12678:function(e,t,n){"use strict";n.r(t),n.d(t,{FlowPanel:function(){return p},PanelContent:function(){return g}});var r=n(14297),o=n(58071),a=n(11253),l=n(26026),i=n(30365),s=n(31087),c=n(91861),d=n(90813),u=n(81710),h=n(82247);function p(e){let{onAddNode:t,onGenerateCode:n,onImportMermaid:a}=e;return(0,r.jsx)(o.s_,{position:"top-left",children:(0,r.jsx)(g,{onAddNode:t,onGenerateCode:n,onImportMermaid:a})})}function g(e){let{onAddNode:t,onGenerateCode:n,onImportMermaid:o}=e,{open:p,onOpen:g,onClose:x}=(0,s.useDisclosure)();return(0,r.jsxs)(c.gC,{gap:4,p:4,bg:"white",borderRadius:"md",boxShadow:"md",children:[(0,r.jsx)(d.x,{fontSize:"lg",fontWeight:"bold",children:"Mermaid フローチャート エディター"}),(0,r.jsxs)(c.gC,{gap:2,align:"start",children:[(0,r.jsx)(d.x,{fontSize:"sm",color:"gray.600",children:"\uD83D\uDCA1 ヒント: ノードをダブルクリックで編集、ドラッグして空の場所で新ノード作成"}),(0,r.jsxs)(c.Ug,{gap:2,display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",children:[(0,r.jsx)(u.z,{startIcon:(0,r.jsx)(a.p,{}),colorScheme:"blue",size:"sm",onClick:t,children:"ノード追加"}),(0,r.jsx)(u.z,{startIcon:(0,r.jsx)(l.d,{}),colorScheme:"green",size:"sm",onClick:n,children:"コード生成"}),(0,r.jsx)(u.z,{startIcon:(0,r.jsx)(i.r,{}),colorScheme:"purple",size:"sm",onClick:g,children:"インポート"})]})]}),(0,r.jsx)(h.ZO,{open:p,onClose:x,onImport:o})]})}},82247:function(e,t,n){"use strict";n.d(t,{_v:function(){return R},ZO:function(){return B}});var r=n(14297),o=n(84922),a=n(4699),l=n(60970);function i(e){let{code:t,showLineNumbers:n=!0,minHeight:i="400px",fontSize:s="14px"}=e;return(0,r.jsx)(o.x,{w:"full",borderRadius:"md",overflow:"hidden",border:"1px solid",borderColor:"border",children:(0,r.jsx)(a.Z,{language:"mermaid",style:l.Z,showLineNumbers:n,customStyle:{margin:0,fontSize:s,minHeight:i},children:t})})}var s=n(18542),c=n(74419),d=n(79164),u=n(32302),h=n(74006),p=n(16152),g=n(31087),x=n(97981),f=n(80677),b=n(91861),m=n(90813),y=n(81710),C=n(17359),w=n(99592),j=n(30178),v=n(65807),E=n(31542),S=n(15213),T=n(13812),k=n(38503),F=n(29586),A=n(11677),N=n(91255),z=n(38614),_=n(23026),D=n(82278);let L=(0,T.memo)((0,N.forwardRef)((e,t)=>{let{value:n,...o}=e,{hasCopied:a,onCopy:l}=(0,z.useClipboard)(n);return(0,r.jsx)(_.u,{alignItems:"center",bg:"success",display:"inline-flex",h:"8",open:a,label:"Copied!",placement:"left",zIndex:"1000",children:(0,r.jsx)(D.h,{ref:t,size:"sm",variant:"unstyled","aria-label":"Copy the code",alignItems:"center",bg:["neutral.800","neutral.900"],border:"1px solid",borderColor:a?"success":"whiteAlpha.600",color:a?"success":"whiteAlpha.600",display:"flex",icon:a?(0,r.jsx)(F.n,{fontSize:"lg"}):(0,r.jsx)(A.T,{fontSize:"md"}),justifyContent:"center",_hover:{borderColor:a?"success":"whiteAlpha.800",color:a?"success":"whiteAlpha.800"},...o,onClick:l})})})),I=[{type:"TD",arrow:s.v},{type:"LR",arrow:c.L},{type:"RL",arrow:d.Y},{type:"BT",arrow:u.H}];function R(e){let{open:t,onClose:n,flowData:o}=e,[a,l]=(0,T.useState)("TD"),s=(0,T.useMemo)(()=>(0,k.LC)(o,a),[o,a]),c=(0,T.useCallback)(()=>{let e=document.createElement("a"),t=new Blob([s],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download="flowchart.mmd",document.body.appendChild(e),e.click(),document.body.removeChild(e)},[s]),{open:d,onOpen:u,onClose:F}=(0,g.useDisclosure)();return(0,r.jsxs)(x.u,{open:t,onClose:n,size:"2xl",children:[(0,r.jsx)(f.x,{children:(0,r.jsxs)(b.Ug,{justify:{base:"space-between",md:"flex-start"},display:{base:"flex",md:"inline-flex"},flexWrap:"wrap",alignItems:"center",children:[(0,r.jsx)(m.x,{children:"生成されたMermaidコード"}),(0,r.jsx)(y.z,{startIcon:(0,r.jsx)(h._,{}),colorScheme:"blue",size:"sm",onClick:c,ml:{base:0,md:"auto"},children:"ダウンロード"}),(0,r.jsxs)(C.v,{open:d,onOpen:u,onClose:F,children:[(0,r.jsx)(w.j,{size:"sm",as:y.z,rightIcon:(0,r.jsx)(p.v,{fontSize:"xl"}),children:a}),(0,r.jsx)(j.q,{children:I.map(e=>(0,r.jsx)(v.sN,{icon:(0,r.jsx)(e.arrow,{}),bgColor:e.type===a?"primary.50":"transparent",onClick:()=>l(e.type),children:e.type},e.type))})]})]})}),(0,r.jsx)(E.o,{}),(0,r.jsxs)(S.f,{pb:6,position:"relative",children:[(0,r.jsx)(L,{value:s,position:"absolute",top:2,right:6,zIndex:1}),(0,r.jsx)(i,{code:s})]})]})}var M=n(23847),O=n(19247),P=n(28555),$=n(60789),Z=n(37143);function H(e){let{value:t,onChange:n,placeholder:a="Mermaidコードを入力...",minHeight:l="300px",fontSize:i="14px"}=e;return(0,r.jsx)(o.x,{w:"full",borderRadius:"md",overflow:"hidden",border:"1px solid",borderColor:"border",bg:"gray.900",color:"white",fontFamily:"mono",sx:{"& textarea::placeholder":{color:"white",opacity:.7}},children:(0,r.jsx)(Z.Z,{value:t,onValueChange:n,highlight:e=>{try{return(0,$.highlight)(e,$.languages.mermaid,"mermaid")}catch(t){return e.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"})[e])}},padding:16,placeholder:a,style:{fontFamily:'"Fira code", "Fira Mono", Consolas, Monaco, "Courier New", monospace',fontSize:i,minHeight:l,lineHeight:"1.5",backgroundColor:"transparent",outline:"none",caretColor:"white"}})})}function B(e){let{open:t,onClose:n,onImport:o}=e,[a,l]=(0,T.useState)(""),[i,s]=(0,T.useState)(null),[c,d]=(0,T.useState)(!1),u=async()=>{if(!a.trim()){s("Mermaidコードを入力してください");return}d(!0),s(null);try{let e=(0,k.LY)(a);if(0===e.nodes.length&&0===e.edges.length){s("有効なMermaidコードが見つかりませんでした。ノードまたはエッジの定義を確認してください。");return}o(e),l(""),n()}catch(e){s("Mermaidコードの解析中にエラーが発生しました")}finally{d(!1)}},h=()=>{l(""),s(null),n()};return(0,r.jsxs)(x.u,{open:t,onClose:h,size:"2xl",children:[(0,r.jsx)(M.Z,{}),(0,r.jsx)(f.x,{children:"Mermaidコードインポート"}),(0,r.jsx)(S.f,{children:(0,r.jsxs)(b.gC,{gap:2,children:[(0,r.jsx)(m.x,{fontSize:"sm",color:"gray.600",children:"Mermaidのフローチャートコードを貼り付けてインポートできます"}),(0,r.jsx)(H,{value:a,onChange:e=>{l(e),s(null)},placeholder:"例:\n".concat("flowchart TD\n    A[開始] --> B{判定}\n    B -->|はい| C[処理A]\n    B -->|いいえ| D[処理B]\n    C --> E[終了]\n    D --> E"),minHeight:"300px"}),i&&(0,r.jsx)(V,{message:i}),(0,r.jsx)(m.x,{fontSize:"xs",color:"gray.500",children:"\uD83D\uDCA1 対応しているノード形状: 四角形[label], ダイヤモンド{label}, 円((label)), 六角形{{label}}, スタジアム([label]), 角丸(label)"})]})}),(0,r.jsxs)(O.m,{children:[(0,r.jsx)(y.z,{onClick:h,children:"キャンセル"}),(0,r.jsx)(y.z,{colorScheme:"blue",onClick:u,loading:c,loadingText:"インポート中...",disabled:!a.trim(),children:"インポート"})]})]})}n(5490),n(17196);let V=e=>{let{message:t}=e;return(0,r.jsxs)(P.bZ,{status:"error",children:[(0,r.jsx)(P.zM,{}),(0,r.jsx)(P.X,{children:t})]})}},28344:function(e,t,n){"use strict";n.r(t),n.d(t,{EditableNode:function(){return x},NodeContent:function(){return f}});var r=n(14297),o=n(58071),a=n(23038),l=n(84922),i=n(13812),s=n(63475),c=n(90813);function d(e){let{value:t,isEditing:n,onDoubleClick:o,onChange:a,onKeyDown:l,onCompositionStart:i,onCompositionEnd:d,onBlur:u}=e;return(0,r.jsx)(r.Fragment,{children:n?(0,r.jsx)(s.I,{value:t,onChange:a,onKeyDown:l,onCompositionStart:i,onCompositionEnd:d,onBlur:u,size:"sm",autoFocus:!0,textAlign:"center",w:"full",h:"24px",p:1,fontSize:"sm",border:"none",bg:"transparent",_focus:{boxShadow:"none",outline:"none"}}):(0,r.jsx)(c.x,{w:"full",fontSize:"sm",fontWeight:"medium",wordBreak:"break-word",lineHeight:"1.2",onDoubleClick:o,children:t})})}var u=n(38503);function h(e){let{value:t,isEditing:n,shapeType:o,onClick:a,onChange:i,onKeyDown:c,onCompositionStart:d,onCompositionEnd:h,onBlur:p}=e,g=(0,u.oq)(o||"rectangle",t);return(0,r.jsx)(l.x,{position:"absolute",top:"-12px",left:"0px",bg:"blue.500",color:"white",px:1,py:"1px",borderRadius:"sm",fontSize:"10px",fontWeight:"medium",cursor:"pointer",onClick:a,_hover:{bg:"blue.600"},zIndex:10,children:n?(0,r.jsx)(s.I,{value:t,onChange:i,onKeyDown:c,onCompositionStart:d,onCompositionEnd:h,onBlur:p,size:"xs",autoFocus:!0,w:"60px",h:"16px",p:0,fontSize:"10px",bg:"white",color:"black",border:"none",_focus:{boxShadow:"none",outline:"none"}}):g})}var p=n(71334),g=n(1261);function x(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{...e}),(0,r.jsx)(o.HH,{type:"target",position:a.Ly.Top}),(0,r.jsx)(o.HH,{type:"source",position:a.Ly.Bottom})]})}function f(e){let{data:t,id:n}=e,[o,a]=(0,i.useState)(!1),[s,c]=(0,i.useState)(!1),[u,x]=(0,i.useState)(t.label),[f,b]=(0,i.useState)(t.variableName||"node".concat(n)),[m,y]=(0,i.useState)(!1),C=(0,i.useRef)(0),w=()=>{Date.now()-C.current<p.vR.DOUBLE_CLICK_THRESHOLD||(s&&v(),a(!0))},j=()=>{a(!1),t.onLabelChange&&t.onLabelChange(n,u)},v=()=>{c(!1),t.onVariableNameChange&&t.onVariableNameChange(n,f)},E=()=>{a(!1),x(t.label)},S=()=>{c(!1),b(t.variableName||"node".concat(n))},T=()=>{y(!0)},k=()=>{y(!1)};return(0,r.jsxs)(l.x,{bg:"white",border:"2px solid #1a365d",borderRadius:"md",p:2,w:"xs",minH:"6xs",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",cursor:"pointer",onDoubleClick:w,_hover:{boxShadow:"md"},position:"relative",children:[(0,r.jsx)(h,{value:f,isEditing:s,shapeType:t.shapeType,onClick:e=>{e.stopPropagation(),e.preventDefault(),C.current=Date.now(),o&&j(),c(!0)},onChange:e=>{b(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||m?"Escape"===e.key&&S():v()},onCompositionStart:T,onCompositionEnd:k,onBlur:v}),(0,r.jsx)(g.NodeMenu,{onDelete:()=>{t.onDelete&&t.onDelete(n)},onEdit:()=>{s&&v(),a(!0)},onEditVariableName:()=>{o&&j(),c(!0)},onShapeChange:e=>{var r;null===(r=t.onShapeTypeChange)||void 0===r||r.call(t,n,e)},currentShape:t.shapeType||"rectangle"}),(0,r.jsx)(d,{value:u,isEditing:o,onDoubleClick:w,onChange:e=>{x(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||m?"Escape"===e.key&&E():j()},onCompositionStart:T,onCompositionEnd:k,onBlur:j})]})}},1261:function(e,t,n){"use strict";n.r(t),n.d(t,{NodeMenu:function(){return x}});var r=n(14297),o=n(20524),a=n(52838),l=n(66959),i=n(83162),s=n(17359),c=n(99592),d=n(82278),u=n(30178),h=n(65807),p=n(34310),g=n(4056);let x=e=>{let{onEdit:t,onEditVariableName:n,onDelete:x,onShapeChange:f,currentShape:b}=e;return(0,r.jsxs)(s.v,{children:[(0,r.jsx)(c.j,{size:"xs",position:"absolute",top:0,right:0,as:d.h,icon:(0,r.jsx)(o.J,{fontSize:"2xl"}),variant:"ghost"}),(0,r.jsxs)(u.q,{children:[(0,r.jsx)(h.sN,{icon:(0,r.jsx)(a.V,{fontSize:"xl"}),onClick:t,children:"ラベル編集"}),(0,r.jsx)(h.sN,{icon:(0,r.jsx)(l.l,{fontSize:"xl"}),onClick:n,children:"変数名編集"}),(0,r.jsx)(p.C,{}),(0,r.jsx)(g.ShapeSelector,{currentShape:b,onShapeChange:f}),(0,r.jsx)(p.C,{}),(0,r.jsx)(h.sN,{color:"danger",icon:(0,r.jsx)(i.X,{fontSize:"xl",color:"danger"}),onClick:x,children:"削除"})]})]})}},4056:function(e,t,n){"use strict";n.r(t),n.d(t,{ShapeSelector:function(){return h}});var r=n(14297),o=n(40197),a=n(17359),l=n(99592),i=n(65807),s=n(30178),c=n(84922),d=n(90813),u=n(71334);let h=e=>{let{currentShape:t,onShapeChange:n}=e;return(0,r.jsxs)(a.v,{children:[(0,r.jsx)(l.j,{as:i.sN,icon:(0,r.jsx)(o.o,{fontSize:"xl"}),children:"ノード形状"}),(0,r.jsx)(s.q,{children:u.eJ.map(e=>(0,r.jsx)(i.sN,{onClick:()=>null==n?void 0:n(e.type),bg:t===e.type?"primary.50":void 0,children:(0,r.jsxs)(c.x,{display:"flex",alignItems:"center",justifyContent:"space-between",w:"full",children:[(0,r.jsx)(d.x,{children:e.label}),(0,r.jsx)(d.x,{fontSize:"sm",color:"muted",fontFamily:"mono",children:e.symbol})]})},e.type))})]})}},71334:function(e,t,n){"use strict";n.d(t,{ab:function(){return o},eJ:function(){return a},vR:function(){return r}});let r={DOUBLE_CLICK_THRESHOLD:300,DEBOUNCE_DELAY:150,IME_COMPOSITION_DELAY:100},o=["arrow","thick","dotted","invisible","bidirectional","bidirectional-thick"],a=[{type:"rectangle",label:"四角形",symbol:"[ ]"},{type:"diamond",label:"菱形",symbol:"{ }"},{type:"rounded",label:"角丸四角",symbol:"( )"},{type:"circle",label:"円形",symbol:"(( ))"},{type:"hexagon",label:"六角形",symbol:"{{ }}"},{type:"stadium",label:"スタジアム",symbol:"([ ])"}]},38503:function(e,t,n){"use strict";n.d(t,{LC:function(){return d},LY:function(){return u},RG:function(){return c},oq:function(){return a},wL:function(){return s}});let r=new Set(["end","start","subgraph","class","classDef","click","style","linkStyle","direction","flowchart","graph","if","else","elseif","while","for","function","return","break","continue"]),o=e=>{if(!e||""===e.trim())return"node_unnamed";let t=e.trim();return r.has(t.toLowerCase())&&(t="node_".concat(t)),/^[0-9]/.test(t)&&(t="_".concat(t)),t=(t=t.replace(/\s+/g,"_")).replace(/[^\w\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/g,"_")},a=(e,t)=>{switch(e){case"rectangle":default:return"[".concat(t,"]");case"diamond":return"{".concat(t,"}");case"rounded":return"(".concat(t,")");case"circle":return"((".concat(t,"))");case"hexagon":return"{{".concat(t,"}}");case"stadium":return"([".concat(t,"])")}},l=e=>e&&""!==e.trim()?/^\d+$/.test(e.trim())?e.trim():/^[a-zA-Z0-9\-_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF\s]+$/.test(e)?e:'"'.concat(e.replace(/"/g,'\\"'),'"'):e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"arrow",t=arguments.length>1?arguments[1]:void 0,n=t&&""!==t.trim(),r=n?l(t):"";switch(e){case"arrow":default:return n?" -->|".concat(r,"| "):" --> ";case"thick":return n?" ==>|".concat(r,"| "):" ==> ";case"dotted":return n?" -. ".concat(r," .-> "):" -.-> ";case"invisible":return n?" ~~~|".concat(r,"| "):" ~~~ ";case"bidirectional":return n?" <-->|".concat(r,"| "):" <--> ";case"bidirectional-thick":return n?" <==".concat(r,"==> "):" <==> "}},s=e=>{switch(e){case"arrow":default:return"→";case"thick":return"⇒";case"dotted":return"⇢";case"invisible":return"～";case"bidirectional":return"↔";case"bidirectional-thick":return"⇔"}},c=e=>{switch(e){case"arrow":default:return"通常の矢印 (->)";case"thick":return"太い矢印 (==>)";case"dotted":return"点線矢印 (-.->)";case"invisible":return"非表示 (~~~)";case"bidirectional":return"双方向矢印 (<->)";case"bidirectional-thick":return"太い双方向矢印 (<==>)"}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TD",n="flowchart ".concat(t,"\n");return e.nodes.forEach(e=>{let t=o(e.data.variableName||"node".concat(e.id)),r=a(e.data.shapeType||"rectangle",e.data.label||"");n+="    ".concat(t).concat(r,"\n")}),e.edges.forEach(t=>{let r=e.nodes.find(e=>e.id===t.source),a=e.nodes.find(e=>e.id===t.target);if(r&&a){var l,s;let e=o(r.data.variableName||"node".concat(r.id)),c=o(a.data.variableName||"node".concat(a.id)),d=null===(l=t.data)||void 0===l?void 0:l.label,u=i((null===(s=t.data)||void 0===s?void 0:s.arrowType)||"arrow",d);n+="    ".concat(e).concat(u).concat(c,"\n")}}),n},u=e=>{let t={nodes:[],edges:[]};if(!e||""===e.trim())return t;let n=e.split("\n").map(e=>e.trim()).filter(e=>e).filter(e=>!e.startsWith("flowchart")&&!e.startsWith("graph")),r=new Map;for(let e of n){let t=p(e);t&&r.set(t.id,t)}for(let e of n){let n=g(e);if(n){if(!r.has(n.source)){let t=h(e,n.source);r.set(n.source,t)}if(!r.has(n.target)){let t=h(e,n.target);r.set(n.target,t)}t.edges.push(n)}}return t.nodes=Array.from(r.values()),t},h=(e,t)=>{for(let{pattern:n,shape:r}of[{pattern:"\\[([^\\]]*)\\]",shape:"rectangle"},{pattern:"\\(\\(([^\\)]*)\\)\\)",shape:"circle"},{pattern:"\\{\\{([^\\}]*)\\}\\}",shape:"hexagon"},{pattern:"\\(\\[([^\\]]*)\\]\\)",shape:"stadium"},{pattern:"\\(([^\\)]*)\\)",shape:"rounded"},{pattern:"\\{([^\\}]*)\\}",shape:"diamond"}]){let o=new RegExp("".concat(t).concat(n)),a=e.match(o);if(a)return{id:t,variableName:t,label:a[1]||t,shapeType:r}}return{id:t,variableName:t,label:t,shapeType:"rectangle"}},p=e=>{if(e.includes("-->")||e.includes("==>")||e.includes("-.->")||e.includes("~~~")||e.includes("<-->")||e.includes("<==>"))return null;for(let t of[{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\[([^\]]*)\]$/,shape:"rectangle"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(\(([^)]*)\)\)$/,shape:"circle"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\{\{([^}]*)\}\}$/,shape:"hexagon"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(\[([^\]]*)\]\)$/,shape:"stadium"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\(([^)]*)\)$/,shape:"rounded"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)\{([^}]*)\}$/,shape:"diamond"},{regex:/^([a-zA-Z0-9_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+)$/,shape:"rectangle"}]){let n=e.match(t.regex);if(n){let e=n[1],r=void 0!==n[2]?n[2]:e;if(e.includes(" "))continue;return{id:e,variableName:e,label:r,shapeType:t.shape}}}return null},g=e=>{let t="[a-zA-Z0-9_\\u3040-\\u309F\\u30A0-\\u30FF\\u4E00-\\u9FAF]+",n="(?:\\[[^\\]]*\\]|\\([^)]*\\)|\\{[^}]*\\}|\\(\\([^)]*\\)\\)|\\{\\{[^}]*\\}\\}|\\(\\[[^\\]]*\\]\\))?";for(let r of[{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*<==(.+)==>\\s*(").concat(t,")").concat(n,"$")),arrowType:"bidirectional-thick",labelPosition:"middle"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*<==>\\s*(").concat(t,")").concat(n,"$")),arrowType:"bidirectional-thick"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*<-->\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(n,"$")),arrowType:"bidirectional"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*<-->\\s*(").concat(t,")").concat(n,"$")),arrowType:"bidirectional"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*-\\.\\s*(.+?)\\s*\\.-\\s*>\\s*(").concat(t,")").concat(n,"$")),arrowType:"dotted",labelPosition:"sides"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*-\\.\\s*->\\s*(").concat(t,")").concat(n,"$")),arrowType:"dotted"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*==>\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(n,"$")),arrowType:"thick"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*==>\\s*(").concat(t,")").concat(n,"$")),arrowType:"thick"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*-->\\s*\\|\\s*([^|]*)\\s*\\|\\s*(").concat(t,")").concat(n,"$")),arrowType:"arrow"},{regex:new RegExp("^(".concat(t,")").concat(n,"\\s*-->\\s*(").concat(t,")").concat(n,"$")),arrowType:"arrow"}]){let t=e.match(r.regex);if(t){let e,n;let o="";return"bidirectional-thick"===r.arrowType&&t.length>=4&&t[2]&&""!==t[2].trim()?(e=t[1],o=t[2].trim(),n=t[3]):"sides"===r.labelPosition&&t.length>=4?(e=t[1],o=t[2].trim(),n=t[3]):4===t.length?(e=t[1],o=t[2].trim(),n=t[3]):(e=t[1],n=t[2]),{id:"".concat(e,"-").concat(n),source:e,target:n,label:o,arrowType:r.arrowType}}}return null}}},function(e){e.O(0,[868,62,616,649,876,364,984,681,452,744],function(){return e(e.s=92526)}),_N_E=e.O()}]);